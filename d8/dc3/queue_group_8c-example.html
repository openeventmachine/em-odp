<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EM-ODP: queue_group.c</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doc-stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EM-ODP
   &#160;<span id="projectnumber">3.8.0-1</span>
   </div>
   <div id="projectbrief">Event Machine on ODP</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/dc3/queue_group_8c-example.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">queue_group.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> *   Copyright (c) 2012, Nokia Siemens Networks</span></div>
<div class="line"><span class="comment"> *   Copyright (c) 2014, Nokia Solutions and Networks</span></div>
<div class="line"><span class="comment"> *   All rights reserved.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment"> *   modification, are permitted provided that the following conditions</span></div>
<div class="line"><span class="comment"> *   are met:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment"> *     * Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer in the</span></div>
<div class="line"><span class="comment"> *       documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><span class="comment"> *     * Neither the name of the copyright holder nor the names of its</span></div>
<div class="line"><span class="comment"> *       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment"> *       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment"> *   &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment"> *   A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment"> *   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment"> *   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment"> *   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment"> *   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment"> *   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment"> *   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @file</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Event Machine queue group feature test.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Creates an EO with two queues: a notification queue and a data event queue.</span></div>
<div class="line"><span class="comment"> * The notif queue belongs to the default queue group and can be processed on</span></div>
<div class="line"><span class="comment"> * any core while the data queue belongs to a newly created queue group called</span></div>
<div class="line"><span class="comment"> * &quot;test_qgrp&quot;. The EO-receive function receives a number of data events and</span></div>
<div class="line"><span class="comment"> * then modifies the test queue group (i.e. changes the cores allowed to</span></div>
<div class="line"><span class="comment"> * process events from the data event queue). The test is restarted when the</span></div>
<div class="line"><span class="comment"> * queue group has been modified enough times to include each core at least</span></div>
<div class="line"><span class="comment"> * once.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d7/d5e/event__machine_8h.html">event_machine.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../de/d26/environment_8h.html">event_machine/platform/env/environment.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;cm_setup.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;cm_error_handler.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Defines &amp; macros</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#define TEST_PRINT_COUNT    5</span></div>
<div class="line"><span class="preprocessor">#define TEST_QGRP_NAME_LEN  EM_QUEUE_GROUP_NAME_LEN</span></div>
<div class="line"><span class="preprocessor">#define TEST_QGRP_NAME_BASE &quot;QGrp&quot;</span>  <span class="comment">/* Usage: QGrp001, QGrp002 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** The maximum number of cores this test supports */</span></div>
<div class="line"><span class="preprocessor">#define MAX_CORES  64</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * The number of data events to allocate, these are sent many rounds through</span></div>
<div class="line"><span class="comment"> * the data test_queue for each core mask in the tested queue group</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#define EVENT_DATA_ALLOC_NBR  (MAX_CORES * 16)</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Round &#39;val&#39; to the next multiple of &#39;N&#39; */</span></div>
<div class="line"><span class="preprocessor">#define ROUND_UP(val, N)  ((((val) + ((N) - 1)) / (N)) * (N))</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * EO context used by the application</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Cache line alignment and padding taken care of in &#39;qgrp_shm_t&#39;</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>app_eo_ctx_t {</div>
<div class="line">        em_eo_t eo;</div>
<div class="line"> </div>
<div class="line">        em_queue_t notif_queue;</div>
<div class="line">        em_queue_group_t notif_qgrp;</div>
<div class="line"> </div>
<div class="line">        em_queue_t test_queue;</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#a47c0f0da93addf232d3d6b720f0bb262">em_queue_type_t</a> test_queue_type;<span class="comment"></span></div>
<div class="line"><span class="comment">        /** Has the test_queue been added to the EO? */</span></div>
<div class="line">        <span class="keywordtype">bool</span> test_queue_added;</div>
<div class="line"> </div>
<div class="line">        em_queue_group_t test_qgrp;</div>
<div class="line">        em_event_group_t event_group;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">char</span> test_qgrp_name[TEST_QGRP_NAME_LEN];</div>
<div class="line">        <span class="keywordtype">int</span> test_qgrp_name_nbr;</div>
<div class="line"> </div>
<div class="line">        <a name="_a0"></a><a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> core_mask_max;</div>
<div class="line"> </div>
<div class="line">        uint64_t qgrp_modify_count;</div>
<div class="line">        uint64_t modify_threshold;</div>
<div class="line">        uint64_t print_threshold;</div>
<div class="line">        uint64_t tot_modify_count;</div>
<div class="line">        uint64_t tot_modify_count_check;</div>
<div class="line">} app_eo_ctx_t;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Queue context for the test queue (receives data events, NOT notifications)</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Cache line alignment and padding taken care of in &#39;qgrp_shm_t&#39;</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>app_q_ctx_t {</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Use atomic operations to suit any queue type.</span></div>
<div class="line"><span class="comment">         * An atomic queue does not need this but parallel and</span></div>
<div class="line"><span class="comment">         * parallel-ordered do so opt to always use.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a name="_a1"></a><a class="code" href="../../d5/dcc/struct__env__atomic64.html">env_atomic64_t</a> event_count;</div>
<div class="line">} app_q_ctx_t;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Application event</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">union </span>app_event_t {<span class="comment"></span></div>
<div class="line"><span class="comment">        /** Event id: notification */</span></div>
<div class="line"><span class="preprocessor">        #define EVENT_NOTIF 1</span><span class="comment"></span></div>
<div class="line"><span class="comment">        /** Event id: data */</span></div>
<div class="line"><span class="preprocessor">        #define EVENT_DATA  2</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">        /** Id is first in all events */</span></div>
<div class="line">        uint32_t id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">        /** Event: notification */</span></div>
<div class="line">        <span class="keyword">struct </span>{</div>
<div class="line">                uint32_t id;</div>
<div class="line">                <span class="keyword">enum</span> {</div>
<div class="line">                        NOTIF_START_DONE,</div>
<div class="line">                        NOTIF_RESTART,</div>
<div class="line">                        NOTIF_QUEUE_GROUP_MODIFY_DONE_FIRST,</div>
<div class="line">                        NOTIF_QUEUE_GROUP_MODIFY_DONE,</div>
<div class="line">                        NOTIF_EVENT_GROUP_DATA_DONE</div>
<div class="line">                } type;</div>
<div class="line"> </div>
<div class="line">                em_queue_group_t used_group;</div>
<div class="line">                <a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> core_mask;</div>
<div class="line">        } notif;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">        /** Event: data */</span></div>
<div class="line">        <span class="keyword">struct </span>{</div>
<div class="line">                uint32_t id;</div>
<div class="line">                em_queue_group_t used_group;</div>
<div class="line">        } data;</div>
<div class="line">} app_event_t;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Statistics for each core, pad to cache line size</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">union </span>core_stat_t {</div>
<div class="line">        uint8_t u8[<a name="a2"></a><a class="code" href="../../de/d26/environment_8h.html#aba71635a146e563689c50f1be15cb267">ENV_CACHE_LINE_SIZE</a>] <a name="a3"></a><a class="code" href="../../de/d26/environment_8h.html#a13093fb72d4f1f0be2f85cf449f4d543">ENV_CACHE_LINE_ALIGNED</a>;</div>
<div class="line">        <span class="keyword">struct </span>{</div>
<div class="line">                uint64_t event_count;</div>
<div class="line">        };</div>
<div class="line">} core_stat_t;</div>
<div class="line"> </div>
<div class="line">COMPILE_TIME_ASSERT(<span class="keyword">sizeof</span>(core_stat_t) == <a class="code" href="../../de/d26/environment_8h.html#aba71635a146e563689c50f1be15cb267">ENV_CACHE_LINE_SIZE</a>,</div>
<div class="line">                    CORE_STAT_T__SIZE_ERROR);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Queue Group test shared memory</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>qgrp_shm_t {</div>
<div class="line">        em_pool_t pool <a class="code" href="../../de/d26/environment_8h.html#a13093fb72d4f1f0be2f85cf449f4d543">ENV_CACHE_LINE_ALIGNED</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Number of EM cores running the application */</span></div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> core_count;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">        /** The application has seen the exit_flag and is ready for tear down */</span></div>
<div class="line">        <a name="_a4"></a><a class="code" href="../../dd/d03/struct__env__atomic32.html">env_atomic32_t</a> exit_ack;</div>
<div class="line"> </div>
<div class="line">        app_eo_ctx_t app_eo_ctx <a class="code" href="../../de/d26/environment_8h.html#a13093fb72d4f1f0be2f85cf449f4d543">ENV_CACHE_LINE_ALIGNED</a>;</div>
<div class="line"> </div>
<div class="line">        app_q_ctx_t app_q_ctx <a class="code" href="../../de/d26/environment_8h.html#a13093fb72d4f1f0be2f85cf449f4d543">ENV_CACHE_LINE_ALIGNED</a>;</div>
<div class="line"> </div>
<div class="line">        core_stat_t core_stat[MAX_CORES] <a class="code" href="../../de/d26/environment_8h.html#a13093fb72d4f1f0be2f85cf449f4d543">ENV_CACHE_LINE_ALIGNED</a>;</div>
<div class="line">} qgrp_shm_t;</div>
<div class="line"> </div>
<div class="line">COMPILE_TIME_ASSERT(<span class="keyword">sizeof</span>(qgrp_shm_t) % <a class="code" href="../../de/d26/environment_8h.html#aba71635a146e563689c50f1be15cb267">ENV_CACHE_LINE_SIZE</a> == 0,</div>
<div class="line">                    QGRP_SHM_T__SIZE_ERROR);</div>
<div class="line">COMPILE_TIME_ASSERT(offsetof(qgrp_shm_t, app_eo_ctx) % <a class="code" href="../../de/d26/environment_8h.html#aba71635a146e563689c50f1be15cb267">ENV_CACHE_LINE_SIZE</a></div>
<div class="line">                    == 0, OFFSETOF_EO_CTX_ERROR);</div>
<div class="line">COMPILE_TIME_ASSERT(offsetof(qgrp_shm_t, app_q_ctx) % <a class="code" href="../../de/d26/environment_8h.html#aba71635a146e563689c50f1be15cb267">ENV_CACHE_LINE_SIZE</a></div>
<div class="line">                    == 0, OFFSETOF_Q_CTX_ERROR);</div>
<div class="line">COMPILE_TIME_ASSERT(offsetof(qgrp_shm_t, core_stat) % <a class="code" href="../../de/d26/environment_8h.html#aba71635a146e563689c50f1be15cb267">ENV_CACHE_LINE_SIZE</a></div>
<div class="line">                    == 0, OFFSETOF_CORE_STAT_ERROR);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** EM-core local pointer to shared memory */</span></div>
<div class="line"><span class="keyword">static</span> <a name="a5"></a><a class="code" href="../../de/d26/environment_8h.html#a2b2462b2491461a5c14adb1eb4493a8c">ENV_LOCAL</a> qgrp_shm_t *qgrp_shm;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">receive(<span class="keywordtype">void</span> *eo_context, em_event_t event, <a class="code" href="../../d4/d11/event__machine__types_8h.html#a49fd700da185b0f64834bf967479a992">em_event_type_t</a> type,</div>
<div class="line">        em_queue_t queue, <span class="keywordtype">void</span> *queue_context);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">receive_event_notif(app_eo_ctx_t *eo_ctx, em_event_t event,</div>
<div class="line">                    em_queue_t queue, app_q_ctx_t *q_ctx);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">notif_start_done(app_eo_ctx_t *eo_ctx, em_event_t event, em_queue_t queue);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">notif_queue_group_modify_done(app_eo_ctx_t *eo_ctx, em_event_t event,</div>
<div class="line">                              em_queue_t queue);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">notif_event_group_data_done(app_eo_ctx_t *eo_ctx, em_event_t event,</div>
<div class="line">                            em_queue_t queue);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">receive_event_data(app_eo_ctx_t *eo_ctx, em_event_t event,</div>
<div class="line">                   em_queue_t queue, app_q_ctx_t *q_ctx);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> await_exit_ack(<span class="keywordtype">void</span>);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div>
<div class="line">start(<span class="keywordtype">void</span> *eo_context, em_eo_t eo, <span class="keyword">const</span> <a name="_a6"></a><a class="code" href="../../de/dc0/structem__eo__conf__t.html">em_eo_conf_t</a> *conf);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div>
<div class="line">stop(<span class="keywordtype">void</span> *eo_context, em_eo_t eo);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div>
<div class="line">start_local(<span class="keywordtype">void</span> *eo_context, em_eo_t eo);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div>
<div class="line">stop_local(<span class="keywordtype">void</span> *eo_context, em_eo_t eo);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">next_core_mask(<a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> *new_mask, <a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> *max_mask, <span class="keywordtype">int</span> count);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Main function</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Call cm_setup() to perform test &amp; EM setup common for all the</span></div>
<div class="line"><span class="comment"> * test applications.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * cm_setup() will call test_init() and test_start() and launch</span></div>
<div class="line"><span class="comment"> * the EM dispatch loop on every EM-core.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> cm_setup(argc, argv);</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Init of the Queue Group test application.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @attention Run on all cores.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @see cm_setup() for setup and dispatch.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> test_init(<span class="keyword">const</span> appl_conf_t *appl_conf)</div>
<div class="line">{</div>
<div class="line">        (void)appl_conf;</div>
<div class="line">        <span class="keywordtype">int</span> core = <a name="a7"></a><a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (core == 0) {</div>
<div class="line">                qgrp_shm = env_shared_reserve(<span class="stringliteral">&quot;QueueGroupSharedMem&quot;</span>,</div>
<div class="line">                                              <span class="keyword">sizeof</span>(qgrp_shm_t));</div>
<div class="line">                <a name="a8"></a><a class="code" href="../../db/da0/group__em__error.html#gaf7332965c5deaa69411136e8d36089c6">em_register_error_handler</a>(test_error_handler);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                qgrp_shm = env_shared_lookup(<span class="stringliteral">&quot;QueueGroupSharedMem&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (qgrp_shm == NULL) {</div>
<div class="line">                test_error(<a name="a9"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xdead,</div>
<div class="line">                           <span class="stringliteral">&quot;Queue Group test init failed on EM-core: %u\n&quot;</span>,</div>
<div class="line">                           <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>());</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (core == 0) {</div>
<div class="line">                memset(qgrp_shm, 0, <span class="keyword">sizeof</span>(qgrp_shm_t));</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Startup of the Queue Group test application.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @attention Run only on EM core 0.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @param appl_conf Application configuration</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @see cm_setup() for setup and dispatch.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> test_start(<span class="keyword">const</span> appl_conf_t *appl_conf)</div>
<div class="line">{</div>
<div class="line">        app_event_t *app_event;</div>
<div class="line">        em_event_t event;</div>
<div class="line">        em_queue_group_t default_group;</div>
<div class="line">        em_queue_t notif_queue;</div>
<div class="line">        em_event_group_t event_group;</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> err, start_err = <a name="a10"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a1f9dbd41491db385bd4a3813e2f030a5">EM_ERROR</a>;</div>
<div class="line">        em_eo_t eo;</div>
<div class="line">        <a name="_a11"></a><a class="code" href="../../d8/db3/structem__notif__t.html">em_notif_t</a> notif_tbl[1];</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Store the event pool to use, use the EM default pool if no other</span></div>
<div class="line"><span class="comment">         * pool is provided through the appl_conf.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (appl_conf-&gt;num_pools &gt;= 1)</div>
<div class="line">                qgrp_shm-&gt;pool = appl_conf-&gt;pools[0];</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                qgrp_shm-&gt;pool = <a name="a12"></a><a class="code" href="../../db/d6d/event__machine__hw__config_8h.html#aaa0a290a45f4b1280f3330fadde6bfde">EM_POOL_DEFAULT</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Store the number of EM-cores running the application */</span></div>
<div class="line">        qgrp_shm-&gt;core_count = appl_conf-&gt;core_count;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;***********************************************************\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;EM APPLICATION: &#39;%s&#39; initializing:\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;  %s: %s() - EM-core:%d\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;  Application running on %u EM-cores (procs:%u, threads:%u)\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;  using event pool:%&quot;</span> <a name="a13"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a5f1ebfb654b7ec3169e068aa3776ff79">PRI_POOL</a> <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;***********************************************************\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">                   appl_conf-&gt;name, NO_PATH(__FILE__), __func__, <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>(),</div>
<div class="line">                   appl_conf-&gt;core_count, appl_conf-&gt;num_procs, appl_conf-&gt;num_threads,</div>
<div class="line">                   qgrp_shm-&gt;pool);</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(qgrp_shm-&gt;pool == <a name="a14"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a67fed61187c93569c92da0647970a29f">EM_POOL_UNDEF</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Undefined application event pool!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(qgrp_shm-&gt;core_count &gt; MAX_CORES,</div>
<div class="line">                      <span class="stringliteral">&quot;Test started on too many cores(%i)!\n&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;Max supported core count for this test is: %u\n&quot;</span>,</div>
<div class="line">                      qgrp_shm-&gt;core_count, MAX_CORES);</div>
<div class="line"> </div>
<div class="line">        env_atomic32_init(&amp;qgrp_shm-&gt;exit_ack);</div>
<div class="line">        env_atomic32_set(&amp;qgrp_shm-&gt;exit_ack, 0);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Create the application EO and queues</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        eo = <a name="a15"></a><a class="code" href="../../d8/d5f/group__em__eo.html#ga196c7caa1177575fd424e9a0d2854da6">em_eo_create</a>(<span class="stringliteral">&quot;test_appl_queue_group&quot;</span>,</div>
<div class="line">                          start, start_local, stop, stop_local,</div>
<div class="line">                          receive, &amp;qgrp_shm-&gt;app_eo_ctx);</div>
<div class="line"> </div>
<div class="line">        default_group = <a name="a16"></a><a class="code" href="../../d9/d01/group__em__queue__group.html#ga17b2712720cfb7a5875ad21deb39b565">em_queue_group_find</a>(<span class="stringliteral">&quot;default&quot;</span>);</div>
<div class="line">        <span class="comment">/* Verify that the find-func worked correctly. */</span></div>
<div class="line">        test_fatal_if(default_group != <a name="a17"></a><a class="code" href="../../db/d6d/event__machine__hw__config_8h.html#ae56af1c575498ec19f0836ee916d0eb9">EM_QUEUE_GROUP_DEFAULT</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Default queue group(%&quot;</span> <a name="a18"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;) not found!&quot;</span>,</div>
<div class="line">                      default_group);</div>
<div class="line"> </div>
<div class="line">        notif_queue = <a name="a19"></a><a class="code" href="../../de/d3c/group__em__queue.html#gaef257858d1fa660524f198dba20fa9eb">em_queue_create</a>(<span class="stringliteral">&quot;notif_queue&quot;</span>, <a name="a20"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032">EM_QUEUE_TYPE_ATOMIC</a>,</div>
<div class="line">                                      <a name="a21"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a8171ccd1b7a0df99a6c7d0f3ec82e52fac38f313458eaca8b4a7f1c04fb20fdf1">EM_QUEUE_PRIO_HIGH</a>, default_group, NULL);</div>
<div class="line">        test_fatal_if(notif_queue == <a name="a22"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#ae8ba676fb5528d220363edad0aeef1ff">EM_QUEUE_UNDEF</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Notification queue creation failed!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        err = <a name="a23"></a><a class="code" href="../../d8/d5f/group__em__eo.html#gac9b818edd466228b6fb653bd9337da3e">em_eo_add_queue_sync</a>(eo, notif_queue);</div>
<div class="line">        test_fatal_if(err != <a name="a24"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Notification queue add to EO failed:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line"> </div>
<div class="line">        event_group = <a name="a25"></a><a class="code" href="../../d8/d4c/group__em__event__group.html#ga59755895fbc8f370c6904610326b2594">em_event_group_create</a>();</div>
<div class="line">        test_fatal_if(event_group == <a name="a26"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#adb766a36099bdc633d8aa36e82e889a2">EM_EVENT_GROUP_UNDEF</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Event group creation failed!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        qgrp_shm-&gt;app_eo_ctx.eo = eo;</div>
<div class="line">        qgrp_shm-&gt;app_eo_ctx.notif_queue = notif_queue;</div>
<div class="line">        qgrp_shm-&gt;app_eo_ctx.notif_qgrp = default_group;</div>
<div class="line">        qgrp_shm-&gt;app_eo_ctx.event_group = event_group;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;Starting EO:%&quot;</span> <a name="a27"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot;\t&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;- Notification Queue=%&quot;</span> <a name="a28"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a0331964318f921644a88d3cc38c122e5">PRI_QUEUE</a> <span class="stringliteral">&quot;\n&quot;</span>, eo, notif_queue);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">event</span> = <a name="a29"></a><a class="code" href="../../d5/d33/group__em__event.html#ga5f0e40f1b0b4892ee16aafe07ba4c90c">em_alloc</a>(<span class="keyword">sizeof</span>(app_event_t), <a name="a30"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1">EM_EVENT_TYPE_SW</a>,</div>
<div class="line">                         qgrp_shm-&gt;pool);</div>
<div class="line">        test_fatal_if(event == <a name="a31"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a8542d9c2c9a29e35ff042b1d59cc479b">EM_EVENT_UNDEF</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Notification event allocation failed&quot;</span>);</div>
<div class="line">        app_event = <a name="a32"></a><a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(event);</div>
<div class="line">        memset(app_event, 0, <span class="keyword">sizeof</span>(*app_event));</div>
<div class="line">        app_event-&gt;notif.id = EVENT_NOTIF;</div>
<div class="line">        app_event-&gt;notif.type = NOTIF_START_DONE;</div>
<div class="line">        <span class="comment">/* Verify group when receiving */</span></div>
<div class="line">        app_event-&gt;notif.used_group = default_group;</div>
<div class="line"> </div>
<div class="line">        notif_tbl[0].<a name="a33"></a><a class="code" href="../../d8/db3/structem__notif__t.html#af11de4e82ee78d6222a18ba93ffefa11">event</a> = event;</div>
<div class="line">        notif_tbl[0].<a name="a34"></a><a class="code" href="../../d8/db3/structem__notif__t.html#a1264d8b918729d1c703571289ea56f25">queue</a> = notif_queue;</div>
<div class="line">        notif_tbl[0].<a name="a35"></a><a class="code" href="../../d8/db3/structem__notif__t.html#a756240ca99311d0b6daf6d3b235aeb93">egroup</a> = <a class="code" href="../../d4/d11/event__machine__types_8h.html#adb766a36099bdc633d8aa36e82e889a2">EM_EVENT_GROUP_UNDEF</a>;</div>
<div class="line"> </div>
<div class="line">        err = <a name="a36"></a><a class="code" href="../../d8/d5f/group__em__eo.html#ga3dabc55c5f2bdd1b46bfe4935979b87d">em_eo_start</a>(eo, &amp;start_err, NULL, 1, notif_tbl);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;em_eo_start(%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot;):%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, eo, err);</div>
<div class="line">        test_fatal_if(start_err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;EO start function:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                      start_err);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_stop(<span class="keyword">const</span> appl_conf_t *appl_conf)</div>
<div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> core = <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>();</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> err;</div>
<div class="line"> </div>
<div class="line">        (void)appl_conf;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;%s() on EM-core %02d\n&quot;</span>, __func__, core);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Await &#39;exit_ack&#39; to be set by the EO */</span></div>
<div class="line">        await_exit_ack();</div>
<div class="line"> </div>
<div class="line">        em_eo_t eo = qgrp_shm-&gt;app_eo_ctx.eo;</div>
<div class="line">        em_event_group_t egrp;</div>
<div class="line">        <a class="code" href="../../d8/db3/structem__notif__t.html">em_notif_t</a> notif_tbl[1] = { {.<a class="code" href="../../d8/db3/structem__notif__t.html#af11de4e82ee78d6222a18ba93ffefa11">event</a> = <a class="code" href="../../d4/d11/event__machine__types_8h.html#a8542d9c2c9a29e35ff042b1d59cc479b">EM_EVENT_UNDEF</a>} };</div>
<div class="line">        <span class="keywordtype">int</span> num_notifs;</div>
<div class="line"> </div>
<div class="line">        err = <a name="a37"></a><a class="code" href="../../d8/d5f/group__em__eo.html#gadce026621953114bd26e5836d9693465">em_eo_stop_sync</a>(eo);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;EO stop:%&quot;</span> PRI_STAT <span class="stringliteral">&quot; EO:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot;&quot;</span>, err, eo);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* No more dispatching of the EO&#39;s events, egrp can be freed */</span></div>
<div class="line"> </div>
<div class="line">        egrp = qgrp_shm-&gt;app_eo_ctx.event_group;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a name="a38"></a><a class="code" href="../../d8/d4c/group__em__event__group.html#ga3088eff7f06c9d1c621a01eab3601fe5">em_event_group_is_ready</a>(egrp)) {</div>
<div class="line">                num_notifs = <a name="a39"></a><a class="code" href="../../d8/d4c/group__em__event__group.html#ga4119a66ac9ed21b11288602e6b68827a">em_event_group_get_notif</a>(egrp, 1, notif_tbl);</div>
<div class="line">                err = <a name="a40"></a><a class="code" href="../../d8/d4c/group__em__event__group.html#ga5b2619e0d19c4a958b06d5f15b652ba3">em_event_group_abort</a>(egrp);</div>
<div class="line">                <span class="keywordflow">if</span> (err == <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a> &amp;&amp; num_notifs == 1)</div>
<div class="line">                        <a name="a41"></a><a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(notif_tbl[0].event);</div>
<div class="line">        }</div>
<div class="line">        err = <a name="a42"></a><a class="code" href="../../d8/d4c/group__em__event__group.html#ga221c47c47f119b44eec0b0a85b7c11ed">em_event_group_delete</a>(egrp);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;egrp:%&quot;</span> <a name="a43"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#adca2f2f8040040218a3ec6795a9f1864">PRI_EGRP</a> <span class="stringliteral">&quot; delete:%&quot;</span> PRI_STAT <span class="stringliteral">&quot; EO:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                      egrp, err, eo);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_term(<span class="keyword">const</span> appl_conf_t *appl_conf)</div>
<div class="line">{</div>
<div class="line">        (void)appl_conf;</div>
<div class="line">        <span class="keywordtype">int</span> core = <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>();</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;%s() on EM-core %02d\n&quot;</span>, __func__, core);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (core == 0) {</div>
<div class="line">                env_shared_free(qgrp_shm);</div>
<div class="line">                <a name="a44"></a><a class="code" href="../../db/da0/group__em__error.html#gab6b469100e5f60670a742d944a6f530b">em_unregister_error_handler</a>();</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Receive function for the test EO</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">receive(<span class="keywordtype">void</span> *eo_context, em_event_t event, <a class="code" href="../../d4/d11/event__machine__types_8h.html#a49fd700da185b0f64834bf967479a992">em_event_type_t</a> type,</div>
<div class="line">        em_queue_t queue, <span class="keywordtype">void</span> *queue_context)</div>
<div class="line">{</div>
<div class="line">        app_eo_ctx_t *eo_ctx = eo_context;</div>
<div class="line">        app_event_t *app_event = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(event);</div>
<div class="line">        <span class="comment">/* Only set for the test_queue */</span></div>
<div class="line">        app_q_ctx_t *q_ctx = queue_context;</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(em_get_type_major(type) != <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1">EM_EVENT_TYPE_SW</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Unexpected event type: 0x%x&quot;</span>, type);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (unlikely(appl_shm-&gt;exit_flag)) {</div>
<div class="line">                <span class="comment">/* Handle exit request */</span></div>
<div class="line">                uint32_t exit_ack = env_atomic32_get(&amp;qgrp_shm-&gt;exit_ack);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (exit_ack) {</div>
<div class="line">                        <a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(event);</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (app_event-&gt;id == EVENT_NOTIF &amp;&amp;</div>
<div class="line">                    (app_event-&gt;notif.type == NOTIF_QUEUE_GROUP_MODIFY_DONE_FIRST ||</div>
<div class="line">                     app_event-&gt;notif.type == NOTIF_QUEUE_GROUP_MODIFY_DONE)) {</div>
<div class="line">                        <span class="comment">/* can be set by multiple cores */</span></div>
<div class="line">                        <span class="keywordflow">if</span> (!exit_ack)</div>
<div class="line">                                env_atomic32_set(&amp;qgrp_shm-&gt;exit_ack, 1);</div>
<div class="line">                        <a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(event);</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">/*</span></div>
<div class="line"><span class="comment">                 * Handle events normally until a MODIFY_DONE has been</span></div>
<div class="line"><span class="comment">                 * received and exit_ack has been set.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (app_event-&gt;id) {</div>
<div class="line">        <span class="keywordflow">case</span> EVENT_NOTIF:</div>
<div class="line">                receive_event_notif(eo_ctx, event, queue, q_ctx);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> EVENT_DATA:</div>
<div class="line">                receive_event_data(eo_ctx, event, queue, q_ctx);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                test_error(<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xdead,</div>
<div class="line">                           <span class="stringliteral">&quot;Unknown event id(%u)!&quot;</span>, app_event-&gt;id);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Handle the notification events received through the notif_queue</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">receive_event_notif(app_eo_ctx_t *eo_ctx, em_event_t event,</div>
<div class="line">                    em_queue_t queue, app_q_ctx_t *q_ctx)</div>
<div class="line">{</div>
<div class="line">        app_event_t *app_event = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(event);</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> err;</div>
<div class="line">        (void)q_ctx;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (app_event-&gt;notif.type) {</div>
<div class="line">        <span class="keywordflow">case</span> NOTIF_RESTART:</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;***********************************************\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;!!! Restarting test !!!\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;***********************************************\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;\n\n\n&quot;</span>);</div>
<div class="line">                eo_ctx-&gt;tot_modify_count_check = 0;</div>
<div class="line">                notif_start_done(eo_ctx, event, queue);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> NOTIF_START_DONE:</div>
<div class="line">                notif_start_done(eo_ctx, event, queue);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> NOTIF_QUEUE_GROUP_MODIFY_DONE_FIRST:</div>
<div class="line">                err = <a class="code" href="../../d8/d5f/group__em__eo.html#gac9b818edd466228b6fb653bd9337da3e">em_eo_add_queue_sync</a>(eo_ctx-&gt;eo, eo_ctx-&gt;test_queue);</div>
<div class="line">                test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                              <span class="stringliteral">&quot;EO add queue:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">                eo_ctx-&gt;test_queue_added = <span class="keyword">true</span>;</div>
<div class="line">                notif_queue_group_modify_done(eo_ctx, event, queue);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> NOTIF_QUEUE_GROUP_MODIFY_DONE:</div>
<div class="line">                notif_queue_group_modify_done(eo_ctx, event, queue);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> NOTIF_EVENT_GROUP_DATA_DONE:</div>
<div class="line">                notif_event_group_data_done(eo_ctx, event, queue);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                test_error(<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xdead,</div>
<div class="line">                           <span class="stringliteral">&quot;Unknown notification type:%i!&quot;</span>,</div>
<div class="line">                           app_event-&gt;notif.type);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Helper for receive_event_notif() */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">notif_start_done(app_eo_ctx_t *eo_ctx, em_event_t event, em_queue_t queue)</div>
<div class="line">{</div>
<div class="line">        em_queue_group_t new_qgrp;</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#a47c0f0da93addf232d3d6b720f0bb262">em_queue_type_t</a> new_qtype;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *new_qtype_str;</div>
<div class="line">        <a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> core_mask;</div>
<div class="line">        <a class="code" href="../../d8/db3/structem__notif__t.html">em_notif_t</a> notif_tbl;</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> err;</div>
<div class="line">        <span class="keyword">const</span> em_queue_group_t qgrp_curr = <a name="a45"></a><a class="code" href="../../de/d3c/group__em__queue.html#gacab36f3033ecd8d67e56433605eb4648">em_queue_get_group</a>(queue);</div>
<div class="line">        app_event_t *app_event = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(event);</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(app_event-&gt;notif.used_group != qgrp_curr,</div>
<div class="line">                      <span class="stringliteral">&quot;Qgrp mismatch: %&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;!=%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;!&quot;</span>,</div>
<div class="line">                      app_event-&gt;notif.used_group, qgrp_curr);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create a test queue group */</span></div>
<div class="line">        snprintf(&amp;eo_ctx-&gt;test_qgrp_name[0],</div>
<div class="line">                 <span class="keyword">sizeof</span>(eo_ctx-&gt;test_qgrp_name), <span class="stringliteral">&quot;%s%03i&quot;</span>,</div>
<div class="line">                 TEST_QGRP_NAME_BASE, eo_ctx-&gt;test_qgrp_name_nbr);</div>
<div class="line"> </div>
<div class="line">        eo_ctx-&gt;test_qgrp_name[TEST_QGRP_NAME_LEN - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">        eo_ctx-&gt;test_qgrp_name_nbr = (eo_ctx-&gt;test_qgrp_name_nbr + 1)</div>
<div class="line">                                        % 1000; <span class="comment">/* Range 0-999 */</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Start with EM core-0 (it&#39;s always running) */</span></div>
<div class="line">        <a name="a46"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#af950c0bca4c115cd0896785d2a138979">em_core_mask_zero</a>(&amp;core_mask);</div>
<div class="line">        <a name="a47"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a71101da80fc4d14e0bda24dd0408495c">em_core_mask_set</a>(0, &amp;core_mask);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Reuse event */</span></div>
<div class="line">        app_event-&gt;notif.type = NOTIF_QUEUE_GROUP_MODIFY_DONE_FIRST;</div>
<div class="line">        app_event-&gt;notif.used_group = eo_ctx-&gt;notif_qgrp;</div>
<div class="line"> </div>
<div class="line">        notif_tbl.<a class="code" href="../../d8/db3/structem__notif__t.html#af11de4e82ee78d6222a18ba93ffefa11">event</a> = event; <span class="comment">/* = app_event-&gt;notif */</span></div>
<div class="line">        notif_tbl.<a class="code" href="../../d8/db3/structem__notif__t.html#a1264d8b918729d1c703571289ea56f25">queue</a> = queue;</div>
<div class="line">        notif_tbl.<a class="code" href="../../d8/db3/structem__notif__t.html#a756240ca99311d0b6daf6d3b235aeb93">egroup</a> = <a class="code" href="../../d4/d11/event__machine__types_8h.html#adb766a36099bdc633d8aa36e82e889a2">EM_EVENT_GROUP_UNDEF</a>;</div>
<div class="line"> </div>
<div class="line">        <a name="a48"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a53aa3f224c597fd38ca5c5a3cbf1e744">em_core_mask_copy</a>(&amp;app_event-&gt;notif.core_mask, &amp;core_mask);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Create the queue group!</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        new_qgrp = <a name="a49"></a><a class="code" href="../../d9/d01/group__em__queue__group.html#ga5660d6d2ae52d46a31a3de832a32be5d">em_queue_group_create</a>(eo_ctx-&gt;test_qgrp_name, &amp;core_mask,</div>
<div class="line">                                         1, &amp;notif_tbl);</div>
<div class="line">        test_fatal_if(new_qgrp == <a name="a50"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a3f2bef96eaf8b2855699d6adee7758f4">EM_QUEUE_GROUP_UNDEF</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Queue group creation failed!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (eo_ctx-&gt;test_qgrp != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a3f2bef96eaf8b2855699d6adee7758f4">EM_QUEUE_GROUP_UNDEF</a>) {</div>
<div class="line">                <span class="comment">/*</span></div>
<div class="line"><span class="comment">                 * Delete group - no need for notifs since &#39;modify to zero</span></div>
<div class="line"><span class="comment">                 * core mask&#39; already done &amp; queue deleted from group. Do the</span></div>
<div class="line"><span class="comment">                 * delete after the create to force creation of another</span></div>
<div class="line"><span class="comment">                 * queue group -&gt; avoids always running the test with the same</span></div>
<div class="line"><span class="comment">                 * queue group.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                err = <a name="a51"></a><a class="code" href="../../d9/d01/group__em__queue__group.html#gaa0231c3fa0532cd4b9d8ebada73c394e">em_queue_group_delete</a>(eo_ctx-&gt;test_qgrp, 0, NULL);</div>
<div class="line">                test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                              <span class="stringliteral">&quot;Qgrp delete:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* Store the new queue group to use for this test round */</span></div>
<div class="line">        eo_ctx-&gt;test_qgrp = new_qgrp;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Create a test queue for data events. The queue belongs to</span></div>
<div class="line"><span class="comment">         * the test queue group. Change the queue type for every new</span></div>
<div class="line"><span class="comment">         * test run.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">switch</span> (eo_ctx-&gt;test_queue_type) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032">EM_QUEUE_TYPE_ATOMIC</a>:</div>
<div class="line">                new_qtype = <a name="a52"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea">EM_QUEUE_TYPE_PARALLEL</a>;</div>
<div class="line">                new_qtype_str = <span class="stringliteral">&quot;PARALLEL&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea">EM_QUEUE_TYPE_PARALLEL</a>:</div>
<div class="line">                new_qtype = <a name="a53"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa581ffa79b1fb6bbde9fcbaa99cb4a8f">EM_QUEUE_TYPE_PARALLEL_ORDERED</a>;</div>
<div class="line">                new_qtype_str = <span class="stringliteral">&quot;PARALLEL_ORDERED&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                new_qtype = <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032">EM_QUEUE_TYPE_ATOMIC</a>;</div>
<div class="line">                new_qtype_str = <span class="stringliteral">&quot;ATOMIC&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        eo_ctx-&gt;test_queue_type = new_qtype;</div>
<div class="line">        eo_ctx-&gt;test_queue = <a class="code" href="../../de/d3c/group__em__queue.html#gaef257858d1fa660524f198dba20fa9eb">em_queue_create</a>(<span class="stringliteral">&quot;test_queue&quot;</span>,</div>
<div class="line">                                             eo_ctx-&gt;test_queue_type,</div>
<div class="line">                                             <a name="a54"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a8171ccd1b7a0df99a6c7d0f3ec82e52fa2311aaab5842cd6b78e4587be0fbf0ca">EM_QUEUE_PRIO_NORMAL</a>,</div>
<div class="line">                                             eo_ctx-&gt;test_qgrp, NULL);</div>
<div class="line">        test_fatal_if(eo_ctx-&gt;test_queue == <a class="code" href="../../d4/d11/event__machine__types_8h.html#ae8ba676fb5528d220363edad0aeef1ff">EM_QUEUE_UNDEF</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Test queue creation failed!&quot;</span>);</div>
<div class="line">        eo_ctx-&gt;test_queue_added = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;Created test queue:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0331964318f921644a88d3cc38c122e5">PRI_QUEUE</a> <span class="stringliteral">&quot; type:%s(%u)\t&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;queue group:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot; (name:\&quot;%s\&quot;)\n&quot;</span>,</div>
<div class="line">                   eo_ctx-&gt;test_queue, new_qtype_str, eo_ctx-&gt;test_queue_type,</div>
<div class="line">                   eo_ctx-&gt;test_qgrp, eo_ctx-&gt;test_qgrp_name);</div>
<div class="line"> </div>
<div class="line">        memset(&amp;qgrp_shm-&gt;app_q_ctx, 0, <span class="keyword">sizeof</span>(qgrp_shm-&gt;app_q_ctx));</div>
<div class="line">        env_atomic64_init(&amp;qgrp_shm-&gt;app_q_ctx.event_count);</div>
<div class="line"> </div>
<div class="line">        err = <a name="a55"></a><a class="code" href="../../de/d3c/group__em__queue.html#ga83e001b62c2a87bf862fbf695c5e84fa">em_queue_set_context</a>(eo_ctx-&gt;test_queue, &amp;qgrp_shm-&gt;app_q_ctx);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>, <span class="stringliteral">&quot;Set queue context:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Synchronize EO context. Event is sent through notification,</span></div>
<div class="line"><span class="comment">         * which might have happened before we write the eo_ctx.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        env_sync_mem();</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Helper for receive_event_notif() */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">notif_queue_group_modify_done(app_eo_ctx_t *eo_ctx, em_event_t event,</div>
<div class="line">                              em_queue_t queue)</div>
<div class="line">{</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> err;</div>
<div class="line">        <span class="keyword">const</span> em_queue_group_t qgrp_curr = <a class="code" href="../../de/d3c/group__em__queue.html#gacab36f3033ecd8d67e56433605eb4648">em_queue_get_group</a>(queue);</div>
<div class="line">        app_event_t *app_event = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(event);</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(app_event-&gt;notif.used_group != qgrp_curr,</div>
<div class="line">                      <span class="stringliteral">&quot;Qgrp mismatch: %&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;!=%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;!&quot;</span>,</div>
<div class="line">                      app_event-&gt;notif.used_group, qgrp_curr);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (unlikely(<a name="a56"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a4a719b1109eb9b3aa5a9f6eca257bb8d">em_core_mask_iszero</a>(&amp;app_event-&gt;notif.core_mask))) {</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;*************************************\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;All cores removed from QueueGroup!\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;*************************************\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                test_fatal_if(eo_ctx-&gt;tot_modify_count !=</div>
<div class="line">                              eo_ctx-&gt;tot_modify_count_check,</div>
<div class="line">                              <span class="stringliteral">&quot;Modify count != actual count:\t&quot;</span></div>
<div class="line">                              <span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot; vs %&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                              eo_ctx-&gt;tot_modify_count,</div>
<div class="line">                              eo_ctx-&gt;tot_modify_count_check);</div>
<div class="line"> </div>
<div class="line">                err = <a name="a57"></a><a class="code" href="../../d8/d5f/group__em__eo.html#gae99c4891a050c3a51f946f3dc51de029">em_eo_remove_queue_sync</a>(eo_ctx-&gt;eo,</div>
<div class="line">                                              eo_ctx-&gt;test_queue);</div>
<div class="line">                test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                              <span class="stringliteral">&quot;Remove test queue:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">                eo_ctx-&gt;test_queue_added = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Deleting test queue:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0331964318f921644a88d3cc38c122e5">PRI_QUEUE</a> <span class="stringliteral">&quot;,\t&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;Qgrp ID:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot; (name:\&quot;%s\&quot;)\n&quot;</span>,</div>
<div class="line">                           eo_ctx-&gt;test_queue, eo_ctx-&gt;test_qgrp,</div>
<div class="line">                           eo_ctx-&gt;test_qgrp_name);</div>
<div class="line"> </div>
<div class="line">                err = <a name="a58"></a><a class="code" href="../../de/d3c/group__em__queue.html#ga2a28907b18b348cbb153431c35af5752">em_queue_delete</a>(eo_ctx-&gt;test_queue);</div>
<div class="line">                test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                              <span class="stringliteral">&quot;Delete test queue:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">                eo_ctx-&gt;test_queue = <a class="code" href="../../d4/d11/event__machine__types_8h.html#ae8ba676fb5528d220363edad0aeef1ff">EM_QUEUE_UNDEF</a>;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/*</span></div>
<div class="line"><span class="comment">                 * Delete the queue group later in restart after the</span></div>
<div class="line"><span class="comment">                 * creation of a new group. This forces the creation</span></div>
<div class="line"><span class="comment">                 * and usage of at least two different queue groups.</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                app_event-&gt;notif.id = EVENT_NOTIF;</div>
<div class="line">                app_event-&gt;notif.type = NOTIF_RESTART;</div>
<div class="line">                app_event-&gt;notif.used_group = eo_ctx-&gt;notif_qgrp;</div>
<div class="line">                err = <a name="a59"></a><a class="code" href="../../d5/d33/group__em__event.html#gaca4584a01b71429dfbb045342454b464">em_send</a>(event, eo_ctx-&gt;notif_queue);</div>
<div class="line">                <span class="keywordflow">if</span> (unlikely(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>)) {</div>
<div class="line">                        <a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(event);</div>
<div class="line">                        test_fatal_if(!appl_shm-&gt;exit_flag,</div>
<div class="line">                                      <span class="stringliteral">&quot;Send to notif queue:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">                }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                <a class="code" href="../../d8/db3/structem__notif__t.html">em_notif_t</a> egroup_notif_tbl[1];</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* Reuse the event */</span></div>
<div class="line">                app_event-&gt;notif.id = EVENT_NOTIF;</div>
<div class="line">                app_event-&gt;notif.type = NOTIF_EVENT_GROUP_DATA_DONE;</div>
<div class="line">                app_event-&gt;notif.used_group = eo_ctx-&gt;notif_qgrp;</div>
<div class="line"> </div>
<div class="line">                egroup_notif_tbl[0].<a class="code" href="../../d8/db3/structem__notif__t.html#af11de4e82ee78d6222a18ba93ffefa11">event</a> = event;</div>
<div class="line">                egroup_notif_tbl[0].<a class="code" href="../../d8/db3/structem__notif__t.html#a1264d8b918729d1c703571289ea56f25">queue</a> = eo_ctx-&gt;notif_queue;</div>
<div class="line">                egroup_notif_tbl[0].<a class="code" href="../../d8/db3/structem__notif__t.html#a756240ca99311d0b6daf6d3b235aeb93">egroup</a> = <a class="code" href="../../d4/d11/event__machine__types_8h.html#adb766a36099bdc633d8aa36e82e889a2">EM_EVENT_GROUP_UNDEF</a>;</div>
<div class="line"> </div>
<div class="line">                err = <a name="a60"></a><a class="code" href="../../d8/d4c/group__em__event__group.html#ga6dea07585453ebe66afad458dde5eec5">em_event_group_apply</a>(eo_ctx-&gt;event_group,</div>
<div class="line">                                           eo_ctx-&gt;modify_threshold, 1,</div>
<div class="line">                                           egroup_notif_tbl);</div>
<div class="line">                test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                              <span class="stringliteral">&quot;em_event_group_apply():%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; EVENT_DATA_ALLOC_NBR; i++) {</div>
<div class="line">                        em_event_t ev_data = <a class="code" href="../../d5/d33/group__em__event.html#ga5f0e40f1b0b4892ee16aafe07ba4c90c">em_alloc</a>(<span class="keyword">sizeof</span>(app_event_t),</div>
<div class="line">                                                      <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1">EM_EVENT_TYPE_SW</a>,</div>
<div class="line">                                                      qgrp_shm-&gt;pool);</div>
<div class="line">                        test_fatal_if(ev_data == <a class="code" href="../../d4/d11/event__machine__types_8h.html#a8542d9c2c9a29e35ff042b1d59cc479b">EM_EVENT_UNDEF</a>,</div>
<div class="line">                                      <span class="stringliteral">&quot;Event alloc failed!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                        app_event_t *data_event = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(ev_data);</div>
<div class="line"> </div>
<div class="line">                        data_event-&gt;id = EVENT_DATA;</div>
<div class="line">                        data_event-&gt;data.used_group = eo_ctx-&gt;test_qgrp;</div>
<div class="line"> </div>
<div class="line">                        err = <a name="a61"></a><a class="code" href="../../d8/d4c/group__em__event__group.html#gab1ecab5cd71642d3909ffb6a907fd9a5">em_send_group</a>(ev_data, eo_ctx-&gt;test_queue,</div>
<div class="line">                                            eo_ctx-&gt;event_group);</div>
<div class="line">                        <span class="keywordflow">if</span> (unlikely(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>)) {</div>
<div class="line">                                <a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(ev_data);</div>
<div class="line">                                test_fatal_if(!appl_shm-&gt;exit_flag,</div>
<div class="line">                                              <span class="stringliteral">&quot;Send to test queue:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                                              err);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Helper for receive_event_notif() */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">notif_event_group_data_done(app_eo_ctx_t *eo_ctx, em_event_t event,</div>
<div class="line">                            em_queue_t queue)</div>
<div class="line">{</div>
<div class="line">        <a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> core_mask, used_mask;</div>
<div class="line">        <a class="code" href="../../d8/db3/structem__notif__t.html">em_notif_t</a> notif_tbl;</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> err;</div>
<div class="line">        <span class="keywordtype">int</span> core_count;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keyword">const</span> em_queue_group_t qgrp_curr = <a class="code" href="../../de/d3c/group__em__queue.html#gacab36f3033ecd8d67e56433605eb4648">em_queue_get_group</a>(queue);</div>
<div class="line">        app_event_t *app_event = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(event);</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(app_event-&gt;notif.used_group != qgrp_curr,</div>
<div class="line">                      <span class="stringliteral">&quot;Qgrp mismatch: %&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;!=%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;!&quot;</span>,</div>
<div class="line">                      app_event-&gt;notif.used_group, qgrp_curr);</div>
<div class="line"> </div>
<div class="line">        uint64_t mod_cnt = ++eo_ctx-&gt;qgrp_modify_count;</div>
<div class="line"> </div>
<div class="line">        eo_ctx-&gt;tot_modify_count_check++;</div>
<div class="line"> </div>
<div class="line">        err = <a name="a62"></a><a class="code" href="../../d9/d01/group__em__queue__group.html#ga0a861d268d820d2b6de1341749b4011a">em_queue_group_get_mask</a>(eo_ctx-&gt;test_qgrp, &amp;used_mask);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Get queue group mask:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Get the next core mask for the test group */</span></div>
<div class="line">        next_core_mask(<span class="comment">/*New*/</span> &amp;core_mask, <span class="comment">/*Max*/</span> &amp;eo_ctx-&gt;core_mask_max,</div>
<div class="line">                       eo_ctx-&gt;tot_modify_count_check);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (mod_cnt &gt;= eo_ctx-&gt;print_threshold ||</div>
<div class="line">            <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a4a719b1109eb9b3aa5a9f6eca257bb8d">em_core_mask_iszero</a>(&amp;core_mask)) {</div>
<div class="line">                <span class="keywordtype">char</span> used_mask_str[<a name="a63"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>];</div>
<div class="line">                <span class="keywordtype">char</span> core_mask_str[<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>];</div>
<div class="line"> </div>
<div class="line">                <a name="a64"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a>(used_mask_str, <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>,</div>
<div class="line">                                   &amp;used_mask);</div>
<div class="line">                <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a>(core_mask_str, <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>,</div>
<div class="line">                                   &amp;core_mask);</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;****************************************\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;Received %&quot;</span> PRIu64 <span class="stringliteral">&quot; events on Q:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0331964318f921644a88d3cc38c122e5">PRI_QUEUE</a> <span class="stringliteral">&quot;:\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;    QueueGroup:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;, Curr Coremask:%s\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;Now Modifying:\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;    QueueGroup:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;,  New Coremask:%s\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;****************************************\n&quot;</span>,</div>
<div class="line">                           env_atomic64_get(&amp;qgrp_shm-&gt;app_q_ctx.event_count),</div>
<div class="line">                           eo_ctx-&gt;test_queue, eo_ctx-&gt;test_qgrp,</div>
<div class="line">                           used_mask_str, eo_ctx-&gt;test_qgrp, core_mask_str);</div>
<div class="line"> </div>
<div class="line">                eo_ctx-&gt;qgrp_modify_count = 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Sanity check: verify that all cores that process the queue</span></div>
<div class="line"><span class="comment">         * group actually received events and that other cores do not</span></div>
<div class="line"><span class="comment">         * get any events.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        core_count = qgrp_shm-&gt;core_count;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; core_count; i++) {</div>
<div class="line">                <span class="keyword">const</span> uint64_t ev_count = qgrp_shm-&gt;core_stat[i].event_count;</div>
<div class="line">                <span class="keywordtype">char</span> mstr[<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>];</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (<a name="a65"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a8b20d9f2e2233f7b56d898aedea971ce">em_core_mask_isset</a>(i, &amp;used_mask)) {</div>
<div class="line">                        <span class="keywordflow">if</span> (unlikely(ev_count == 0)) {</div>
<div class="line">                                <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a>(mstr, <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>,</div>
<div class="line">                                                   &amp;used_mask);</div>
<div class="line">                                test_error(<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xdead,</div>
<div class="line">                                           <span class="stringliteral">&quot;No events on core%i, mask:%s&quot;</span>,</div>
<div class="line">                                           i, mstr);</div>
<div class="line">                        }</div>
<div class="line">                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (unlikely(ev_count &gt; 0)) {</div>
<div class="line">                        <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a>(mstr, <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>,</div>
<div class="line">                                           &amp;used_mask);</div>
<div class="line">                        test_error(<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xdead,</div>
<div class="line">                                   <span class="stringliteral">&quot;Events:%&quot;</span> PRIu64 <span class="stringliteral">&quot; on inv.core%i, mask:%s&quot;</span>,</div>
<div class="line">                                   ev_count, i, mstr);</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        memset(qgrp_shm-&gt;core_stat, 0, <span class="keyword">sizeof</span>(qgrp_shm-&gt;core_stat));</div>
<div class="line">        env_atomic64_set(&amp;qgrp_shm-&gt;app_q_ctx.event_count, 0);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Reuse the event */</span></div>
<div class="line">        app_event-&gt;id = EVENT_NOTIF;</div>
<div class="line">        app_event-&gt;notif.type = NOTIF_QUEUE_GROUP_MODIFY_DONE;</div>
<div class="line">        app_event-&gt;notif.used_group = eo_ctx-&gt;notif_qgrp;</div>
<div class="line">        <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a53aa3f224c597fd38ca5c5a3cbf1e744">em_core_mask_copy</a>(&amp;app_event-&gt;notif.core_mask, &amp;core_mask);</div>
<div class="line"> </div>
<div class="line">        notif_tbl.<a class="code" href="../../d8/db3/structem__notif__t.html#af11de4e82ee78d6222a18ba93ffefa11">event</a> = event;</div>
<div class="line">        notif_tbl.<a class="code" href="../../d8/db3/structem__notif__t.html#a1264d8b918729d1c703571289ea56f25">queue</a> = eo_ctx-&gt;notif_queue;</div>
<div class="line">        notif_tbl.<a class="code" href="../../d8/db3/structem__notif__t.html#a756240ca99311d0b6daf6d3b235aeb93">egroup</a> = <a class="code" href="../../d4/d11/event__machine__types_8h.html#adb766a36099bdc633d8aa36e82e889a2">EM_EVENT_GROUP_UNDEF</a>;</div>
<div class="line"> </div>
<div class="line">        err = <a name="a66"></a><a class="code" href="../../d9/d01/group__em__queue__group.html#ga59e3b34707a34f9be634f7b66c25a876">em_queue_group_modify</a>(eo_ctx-&gt;test_qgrp, &amp;core_mask,</div>
<div class="line">                                    1, &amp;notif_tbl);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;em_queue_group_modify():%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Handle the test data events received through the test_queue</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Check that the queue group is valid and send the data back to the same</span></div>
<div class="line"><span class="comment"> * queue for another round.</span></div>
<div class="line"><span class="comment"> * The last event should trigger a notification event to be sent to the</span></div>
<div class="line"><span class="comment"> * notif_queue to begin the queue group modification sequence.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">receive_event_data(app_eo_ctx_t *eo_ctx, em_event_t event,</div>
<div class="line">                   em_queue_t queue, app_q_ctx_t *q_ctx)</div>
<div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> core_id = <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>();</div>
<div class="line">        app_event_t *app_event = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(event);</div>
<div class="line">        em_queue_group_t qgrp_curr = <a class="code" href="../../de/d3c/group__em__queue.html#gacab36f3033ecd8d67e56433605eb4648">em_queue_get_group</a>(queue);</div>
<div class="line">        <a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> used_mask;</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> err;</div>
<div class="line">        <span class="keyword">const</span> uint64_t event_count =</div>
<div class="line">                env_atomic64_add_return(&amp;q_ctx-&gt;event_count, 1);</div>
<div class="line">        qgrp_shm-&gt;core_stat[core_id].event_count++;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Verify that the queue group is correct &amp; expected */</span></div>
<div class="line">        test_fatal_if(app_event-&gt;data.used_group != qgrp_curr,</div>
<div class="line">                      <span class="stringliteral">&quot;Queue grp mismatch:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;!=%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a> <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                      app_event-&gt;data.used_group, qgrp_curr);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Verify that this core is a valid receiver of events in this group */</span></div>
<div class="line">        err = <a class="code" href="../../d9/d01/group__em__queue__group.html#ga0a861d268d820d2b6de1341749b4011a">em_queue_group_get_mask</a>(qgrp_curr, &amp;used_mask);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Get queue group mask:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (unlikely(!<a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a8b20d9f2e2233f7b56d898aedea971ce">em_core_mask_isset</a>(core_id, &amp;used_mask))) {</div>
<div class="line">                <span class="keywordtype">char</span> mask_str[<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>];</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a>(mask_str, <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>, &amp;used_mask);</div>
<div class="line">                test_error(<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xdead,</div>
<div class="line">                           <span class="stringliteral">&quot;Core bit not set in core mask! core:%02i mask:%s&quot;</span>,</div>
<div class="line">                           core_id, mask_str);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Handle the test data event</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (event_count &lt;= eo_ctx-&gt;modify_threshold - EVENT_DATA_ALLOC_NBR) {</div>
<div class="line">                <span class="comment">/* Send the data event for another round */</span></div>
<div class="line">                err = <a class="code" href="../../d8/d4c/group__em__event__group.html#gab1ecab5cd71642d3909ffb6a907fd9a5">em_send_group</a>(event, eo_ctx-&gt;test_queue,</div>
<div class="line">                                    eo_ctx-&gt;event_group);</div>
<div class="line">                <span class="keywordflow">if</span> (unlikely(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>)) {</div>
<div class="line">                        <a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(event);</div>
<div class="line">                        test_fatal_if(!appl_shm-&gt;exit_flag,</div>
<div class="line">                                      <span class="stringliteral">&quot;Send to test queue:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">                }</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event_count &lt;= eo_ctx-&gt;modify_threshold) {</div>
<div class="line">                <span class="comment">/*</span></div>
<div class="line"><span class="comment">                 * Free the events for the last round, an event group</span></div>
<div class="line"><span class="comment">                 * notification event should be triggered when the last event</span></div>
<div class="line"><span class="comment">                 * has been processed</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(event);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                test_error(<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xacdc,</div>
<div class="line">                           <span class="stringliteral">&quot;Invalid event count(%u)!&quot;</span>, event_count);</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Await exit_ack to be set by the EO.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> await_exit_ack(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        env_time_t t_max = env_time_global_from_ns(20 * 1000000000ULL); <span class="comment">/*20s*/</span></div>
<div class="line">        env_time_t t_now = ENV_TIME_NULL;</div>
<div class="line">        env_time_t t_start = env_time_global();</div>
<div class="line">        env_time_t t_end = env_time_sum(t_start, t_max);</div>
<div class="line">        uint64_t ns;</div>
<div class="line">        uint32_t exit_ack = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">long</span> <span class="keywordtype">double</span> sec;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">                <span class="keywordflow">if</span> (!exit_ack)</div>
<div class="line">                        <a name="a67"></a><a class="code" href="../../d3/db8/group__em__dispatcher.html#ga5883e134efdd392c8b792aba701d7cb0">em_dispatch</a>(1);</div>
<div class="line">                exit_ack = env_atomic32_get(&amp;qgrp_shm-&gt;exit_ack);</div>
<div class="line">                t_now = env_time_global();</div>
<div class="line">        } <span class="keywordflow">while</span> (!exit_ack &amp;&amp; env_time_cmp(t_now, t_end) &lt; 0);</div>
<div class="line"> </div>
<div class="line">        ns = env_time_diff_ns(t_now, t_start);</div>
<div class="line">        sec = (<span class="keywordtype">long</span> double)ns / 1000000000.0;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (unlikely(!exit_ack)) {</div>
<div class="line">                test_error(<a name="a68"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a740919266fbb41b8a8127a9ef215eea0a505acce3a1037851c498b436bf6695dc">EM_ERR_TIMEOUT</a>, 0xdead,</div>
<div class="line">                           <span class="stringliteral">&quot;Timeout: No exit_ack within %Lfs!\n&quot;</span>, sec);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;exit_ack in %Lfs on EM-core:%02d =&gt; Tearing down\n&quot;</span>,</div>
<div class="line">                   sec, <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>());</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Global start function for the test EO</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div>
<div class="line">start(<span class="keywordtype">void</span> *eo_context, em_eo_t eo, <span class="keyword">const</span> <a class="code" href="../../de/dc0/structem__eo__conf__t.html">em_eo_conf_t</a> *conf)</div>
<div class="line">{</div>
<div class="line">        app_eo_ctx_t *eo_ctx = eo_context;</div>
<div class="line">        uint64_t tot_modify_count = 0;</div>
<div class="line">        uint64_t tmp;</div>
<div class="line">        <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">        (void)eo;</div>
<div class="line">        (void)conf;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;Queue Group Test - Global EO Start\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        snprintf(&amp;eo_ctx-&gt;test_qgrp_name[0],</div>
<div class="line">                 <span class="keyword">sizeof</span>(eo_ctx-&gt;test_qgrp_name),</div>
<div class="line">                 <span class="stringliteral">&quot;%s%03i&quot;</span>, TEST_QGRP_NAME_BASE, 0);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#af950c0bca4c115cd0896785d2a138979">em_core_mask_zero</a>(&amp;eo_ctx-&gt;core_mask_max);</div>
<div class="line">        <a name="a69"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a8c5596fc6f57fc40af331dbde12b38d1">em_core_mask_set_count</a>(qgrp_shm-&gt;core_count, &amp;eo_ctx-&gt;core_mask_max);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * The values used below in calculations are derived from the way the</span></div>
<div class="line"><span class="comment">         * next_core_mask() function calculates the next core mask to use.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        ret = <a name="a70"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#ab74bd47afaa472062b6617b6839f738f">em_core_mask_get_bits</a>(&amp;tmp, 1, &amp;eo_ctx-&gt;core_mask_max);</div>
<div class="line">        <span class="keywordflow">if</span> (unlikely(ret != 1)) {</div>
<div class="line">                <span class="keywordtype">char</span> mask_str[<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>];</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a>(mask_str, <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a>,</div>
<div class="line">                                   &amp;eo_ctx-&gt;core_mask_max);</div>
<div class="line">                test_error(<a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xdead,</div>
<div class="line">                           <span class="stringliteral">&quot;em_core_mask_get_bits(coremask=%s), ret=%i&quot;</span>,</div>
<div class="line">                           mask_str, ret);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">                tot_modify_count += (tmp &amp; 0xFF) + 1;</div>
<div class="line">                tmp = (tmp &gt;&gt; 4);</div>
<div class="line">                <span class="keywordflow">if</span> (tmp &lt; 0x10)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        } <span class="keywordflow">while</span> (tmp);</div>
<div class="line"> </div>
<div class="line">        tot_modify_count -= 1;</div>
<div class="line"> </div>
<div class="line">        eo_ctx-&gt;tot_modify_count = tot_modify_count;</div>
<div class="line">        eo_ctx-&gt;tot_modify_count_check = 0;</div>
<div class="line"> </div>
<div class="line">        eo_ctx-&gt;print_threshold = tot_modify_count / TEST_PRINT_COUNT;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (eo_ctx-&gt;print_threshold == 0)</div>
<div class="line">                eo_ctx-&gt;print_threshold = 1;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         *  256*15 - 1 is the maximum number of core masks tested when 64</span></div>
<div class="line"><span class="comment">         * cores (max) are running this test.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        eo_ctx-&gt;modify_threshold =</div>
<div class="line">                ((256 * 15 * 0x1000) - 1) / tot_modify_count;</div>
<div class="line">        eo_ctx-&gt;modify_threshold = ROUND_UP(eo_ctx-&gt;modify_threshold,</div>
<div class="line">                                            EVENT_DATA_ALLOC_NBR);</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;*******************************************************\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;Test threshold values set:\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;  Tot group modifies:                     %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;  Events received on group before modify: %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;  Group modify print threshold:           %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;*******************************************************\n&quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">                   tot_modify_count, eo_ctx-&gt;modify_threshold,</div>
<div class="line">                   eo_ctx-&gt;print_threshold);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>;</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Global stop function for the test EO</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div>
<div class="line">stop(<span class="keywordtype">void</span> *eo_context, em_eo_t eo)</div>
<div class="line">{</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> err;</div>
<div class="line">        app_eo_ctx_t *eo_ctx = eo_context;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* remove and delete all of the EO&#39;s queues */</span></div>
<div class="line">        err = <a name="a71"></a><a class="code" href="../../d8/d5f/group__em__eo.html#ga10cf8094caa56026eb0a402d3d22da23">em_eo_remove_queue_all_sync</a>(eo, <a name="a72"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a419c8373b72a8c5ed1c3e3ded3e262e0">EM_TRUE</a>);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;EO remove queue all:%&quot;</span> PRI_STAT <span class="stringliteral">&quot; EO:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                      err, eo);</div>
<div class="line">        <span class="keywordflow">if</span> (eo_ctx-&gt;test_queue != <a class="code" href="../../d4/d11/event__machine__types_8h.html#ae8ba676fb5528d220363edad0aeef1ff">EM_QUEUE_UNDEF</a> &amp;&amp; !eo_ctx-&gt;test_queue_added) {</div>
<div class="line">                err = <a class="code" href="../../de/d3c/group__em__queue.html#ga2a28907b18b348cbb153431c35af5752">em_queue_delete</a>(eo_ctx-&gt;test_queue);</div>
<div class="line">                test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                              <span class="stringliteral">&quot;Delete test queue:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, err);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* delete the EO at the end of the stop-function */</span></div>
<div class="line">        err = <a name="a73"></a><a class="code" href="../../d8/d5f/group__em__eo.html#gae769b19e613b24487beb943cfb926977">em_eo_delete</a>(eo);</div>
<div class="line">        test_fatal_if(err != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;EO delete:%&quot;</span> PRI_STAT <span class="stringliteral">&quot; EO:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                      err, eo);</div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;Queue Group Test - Global EO Stop\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>;</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Local start function for the test EO</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div>
<div class="line">start_local(<span class="keywordtype">void</span> *eo_context, em_eo_t eo)</div>
<div class="line">{</div>
<div class="line">        (void)eo_context;</div>
<div class="line">        (void)eo;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;Queue Group Test - Local EO Start: EM-core:%02d\n&quot;</span>,</div>
<div class="line">                   <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>());</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>;</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Local stop function for the test EO</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div>
<div class="line">stop_local(<span class="keywordtype">void</span> *eo_context, em_eo_t eo)</div>
<div class="line">{</div>
<div class="line">        (void)eo_context;</div>
<div class="line">        (void)eo;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;Queue Group Test - Local EO Stop: EM-core:%02d\n&quot;</span>,</div>
<div class="line">                   <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>());</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>;</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * Update the core mask:</span></div>
<div class="line"><span class="comment"> * E.g. if max_mask is 0xFFFF: 0x0001-0x0100 (256 masks),</span></div>
<div class="line"><span class="comment"> *      0x0010-&gt;0x1000 (256 masks), 0x0100-0x0000 (255 masks)</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">next_core_mask(<a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> *new_mask, <a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> *max_mask, <span class="keywordtype">int</span> count)</div>
<div class="line">{</div>
<div class="line">        uint64_t mask64 = ((uint64_t)(count % 256) + 1) &lt;&lt; (4 * (count / 256));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#af950c0bca4c115cd0896785d2a138979">em_core_mask_zero</a>(new_mask);</div>
<div class="line">        <a name="a74"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#acddedd681d5375f6767615b90ee8563b">em_core_mask_set_bits</a>(&amp;mask64, 1, new_mask);</div>
<div class="line">        <a name="a75"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#ac36c94bc9530a3f0341b85f25a5aa01b">em_core_mask_and</a>(new_mask, new_mask, max_mask);</div>
<div class="line">}</div>
<div class="ttc" id="aenvironment_8h_html"><div class="ttname"><a href="../../de/d26/environment_8h.html">environment.h</a></div></div>
<div class="ttc" id="aenvironment_8h_html_a13093fb72d4f1f0be2f85cf449f4d543"><div class="ttname"><a href="../../de/d26/environment_8h.html#a13093fb72d4f1f0be2f85cf449f4d543">ENV_CACHE_LINE_ALIGNED</a></div><div class="ttdeci">#define ENV_CACHE_LINE_ALIGNED</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/environment_8h_source.html#l00076">environment.h:76</a></div></div>
<div class="ttc" id="aenvironment_8h_html_a2b2462b2491461a5c14adb1eb4493a8c"><div class="ttname"><a href="../../de/d26/environment_8h.html#a2b2462b2491461a5c14adb1eb4493a8c">ENV_LOCAL</a></div><div class="ttdeci">#define ENV_LOCAL</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/environment_8h_source.html#l00057">environment.h:57</a></div></div>
<div class="ttc" id="aenvironment_8h_html_aba71635a146e563689c50f1be15cb267"><div class="ttname"><a href="../../de/d26/environment_8h.html#aba71635a146e563689c50f1be15cb267">ENV_CACHE_LINE_SIZE</a></div><div class="ttdeci">#define ENV_CACHE_LINE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d26/environment_8h_source.html#l00062">environment.h:62</a></div></div>
<div class="ttc" id="aevent__machine_8h_html"><div class="ttname"><a href="../../d7/d5e/event__machine_8h.html">event_machine.h</a></div></div>
<div class="ttc" id="aevent__machine__hw__config_8h_html_aaa0a290a45f4b1280f3330fadde6bfde"><div class="ttname"><a href="../../db/d6d/event__machine__hw__config_8h.html#aaa0a290a45f4b1280f3330fadde6bfde">EM_POOL_DEFAULT</a></div><div class="ttdeci">#define EM_POOL_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6d/event__machine__hw__config_8h_source.html#l00191">event_machine_hw_config.h:191</a></div></div>
<div class="ttc" id="aevent__machine__hw__config_8h_html_ae56af1c575498ec19f0836ee916d0eb9"><div class="ttname"><a href="../../db/d6d/event__machine__hw__config_8h.html#ae56af1c575498ec19f0836ee916d0eb9">EM_QUEUE_GROUP_DEFAULT</a></div><div class="ttdeci">#define EM_QUEUE_GROUP_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6d/event__machine__hw__config_8h_source.html#l00147">event_machine_hw_config.h:147</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_a1bfd8374018370719836fe74ad91d3ee"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a></div><div class="ttdeci">void em_core_mask_tostr(char *mask_str, int len, const em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00156">event_machine_hw_specific.c:156</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_a4a719b1109eb9b3aa5a9f6eca257bb8d"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#a4a719b1109eb9b3aa5a9f6eca257bb8d">em_core_mask_iszero</a></div><div class="ttdeci">int em_core_mask_iszero(const em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00063">event_machine_hw_specific.c:63</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_a53aa3f224c597fd38ca5c5a3cbf1e744"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#a53aa3f224c597fd38ca5c5a3cbf1e744">em_core_mask_copy</a></div><div class="ttdeci">void em_core_mask_copy(em_core_mask_t *dst, const em_core_mask_t *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00082">event_machine_hw_specific.c:82</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_a71101da80fc4d14e0bda24dd0408495c"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#a71101da80fc4d14e0bda24dd0408495c">em_core_mask_set</a></div><div class="ttdeci">void em_core_mask_set(int core, em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00048">event_machine_hw_specific.c:48</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_a8b20d9f2e2233f7b56d898aedea971ce"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#a8b20d9f2e2233f7b56d898aedea971ce">em_core_mask_isset</a></div><div class="ttdeci">int em_core_mask_isset(int core, const em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00058">event_machine_hw_specific.c:58</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_a8c5596fc6f57fc40af331dbde12b38d1"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#a8c5596fc6f57fc40af331dbde12b38d1">em_core_mask_set_count</a></div><div class="ttdeci">void em_core_mask_set_count(int count, em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00076">event_machine_hw_specific.c:76</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_ab74bd47afaa472062b6617b6839f738f"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#ab74bd47afaa472062b6617b6839f738f">em_core_mask_get_bits</a></div><div class="ttdeci">int em_core_mask_get_bits(uint64_t bits[], int len, const em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00115">event_machine_hw_specific.c:115</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_ac36c94bc9530a3f0341b85f25a5aa01b"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#ac36c94bc9530a3f0341b85f25a5aa01b">em_core_mask_and</a></div><div class="ttdeci">void em_core_mask_and(em_core_mask_t *dst, const em_core_mask_t *src1, const em_core_mask_t *src2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00181">event_machine_hw_specific.c:181</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_acddedd681d5375f6767615b90ee8563b"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#acddedd681d5375f6767615b90ee8563b">em_core_mask_set_bits</a></div><div class="ttdeci">void em_core_mask_set_bits(const uint64_t bits[], int len, em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00092">event_machine_hw_specific.c:92</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_af950c0bca4c115cd0896785d2a138979"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#af950c0bca4c115cd0896785d2a138979">em_core_mask_zero</a></div><div class="ttdeci">void em_core_mask_zero(em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00043">event_machine_hw_specific.c:43</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032">EM_QUEUE_TYPE_ATOMIC</a></div><div class="ttdeci">@ EM_QUEUE_TYPE_ATOMIC</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00112">event_machine_hw_types.h:112</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea">EM_QUEUE_TYPE_PARALLEL</a></div><div class="ttdeci">@ EM_QUEUE_TYPE_PARALLEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00117">event_machine_hw_types.h:117</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a368b59e8c18f57c4034420e3ba44e965aa581ffa79b1fb6bbde9fcbaa99cb4a8f"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa581ffa79b1fb6bbde9fcbaa99cb4a8f">EM_QUEUE_TYPE_PARALLEL_ORDERED</a></div><div class="ttdeci">@ EM_QUEUE_TYPE_PARALLEL_ORDERED</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00122">event_machine_hw_types.h:122</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a5f1ebfb654b7ec3169e068aa3776ff79"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a5f1ebfb654b7ec3169e068aa3776ff79">PRI_POOL</a></div><div class="ttdeci">#define PRI_POOL</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00062">event_machine_hw_types.h:62</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a67fed61187c93569c92da0647970a29f"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a67fed61187c93569c92da0647970a29f">EM_POOL_UNDEF</a></div><div class="ttdeci">#define EM_POOL_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00060">event_machine_hw_types.h:60</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a740919266fbb41b8a8127a9ef215eea0a505acce3a1037851c498b436bf6695dc"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a740919266fbb41b8a8127a9ef215eea0a505acce3a1037851c498b436bf6695dc">EM_ERR_TIMEOUT</a></div><div class="ttdeci">@ EM_ERR_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00302">event_machine_hw_types.h:302</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a8171ccd1b7a0df99a6c7d0f3ec82e52fa2311aaab5842cd6b78e4587be0fbf0ca"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a8171ccd1b7a0df99a6c7d0f3ec82e52fa2311aaab5842cd6b78e4587be0fbf0ca">EM_QUEUE_PRIO_NORMAL</a></div><div class="ttdeci">@ EM_QUEUE_PRIO_NORMAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00153">event_machine_hw_types.h:153</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a8171ccd1b7a0df99a6c7d0f3ec82e52fac38f313458eaca8b4a7f1c04fb20fdf1"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a8171ccd1b7a0df99a6c7d0f3ec82e52fac38f313458eaca8b4a7f1c04fb20fdf1">EM_QUEUE_PRIO_HIGH</a></div><div class="ttdeci">@ EM_QUEUE_PRIO_HIGH</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00154">event_machine_hw_types.h:154</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_ac341b7db29d8127e864a45c9bd2a4aa3"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a></div><div class="ttdeci">#define EM_ERROR_SET_FATAL(error)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00428">event_machine_hw_types.h:428</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1">EM_EVENT_TYPE_SW</a></div><div class="ttdeci">@ EM_EVENT_TYPE_SW</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00072">event_machine_hw_types.h:72</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_af244aae440f59c0ad33ffbf186eb0f76"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#af244aae440f59c0ad33ffbf186eb0f76">EM_CORE_MASK_STRLEN</a></div><div class="ttdeci">#define EM_CORE_MASK_STRLEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00247">event_machine_hw_types.h:247</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a0331964318f921644a88d3cc38c122e5"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a0331964318f921644a88d3cc38c122e5">PRI_QUEUE</a></div><div class="ttdeci">#define PRI_QUEUE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00109">event_machine_types.h:109</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a03546e6a7e93665c52d479831e0a6dca"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a></div><div class="ttdeci">#define EM_OK</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00329">event_machine_types.h:329</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a0bf4a25d46e18ee918e684e5deb27fa4"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a></div><div class="ttdeci">#define PRI_EO</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00097">event_machine_types.h:97</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a1f9dbd41491db385bd4a3813e2f030a5"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a1f9dbd41491db385bd4a3813e2f030a5">EM_ERROR</a></div><div class="ttdeci">#define EM_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00337">event_machine_types.h:337</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a3f2bef96eaf8b2855699d6adee7758f4"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a3f2bef96eaf8b2855699d6adee7758f4">EM_QUEUE_GROUP_UNDEF</a></div><div class="ttdeci">#define EM_QUEUE_GROUP_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00127">event_machine_types.h:127</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a419c8373b72a8c5ed1c3e3ded3e262e0"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a419c8373b72a8c5ed1c3e3ded3e262e0">EM_TRUE</a></div><div class="ttdeci">#define EM_TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00053">event_machine_types.h:53</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a47c0f0da93addf232d3d6b720f0bb262"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a47c0f0da93addf232d3d6b720f0bb262">em_queue_type_t</a></div><div class="ttdeci">uint32_t em_queue_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00168">event_machine_types.h:168</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a49fd700da185b0f64834bf967479a992"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a49fd700da185b0f64834bf967479a992">em_event_type_t</a></div><div class="ttdeci">uint32_t em_event_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00085">event_machine_types.h:85</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a8542d9c2c9a29e35ff042b1d59cc479b"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a8542d9c2c9a29e35ff042b1d59cc479b">EM_EVENT_UNDEF</a></div><div class="ttdeci">#define EM_EVENT_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00062">event_machine_types.h:62</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_ac01ba4a56d14c1321b4d8416e54735f8"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#ac01ba4a56d14c1321b4d8416e54735f8">PRI_QGRP</a></div><div class="ttdeci">#define PRI_QGRP</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00129">event_machine_types.h:129</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_adb766a36099bdc633d8aa36e82e889a2"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#adb766a36099bdc633d8aa36e82e889a2">EM_EVENT_GROUP_UNDEF</a></div><div class="ttdeci">#define EM_EVENT_GROUP_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00141">event_machine_types.h:141</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_adca2f2f8040040218a3ec6795a9f1864"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#adca2f2f8040040218a3ec6795a9f1864">PRI_EGRP</a></div><div class="ttdeci">#define PRI_EGRP</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00143">event_machine_types.h:143</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_adddd88868f7aa0d32b3e40245eb4ef8f"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div><div class="ttdeci">uint32_t em_status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00321">event_machine_types.h:321</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_ae8ba676fb5528d220363edad0aeef1ff"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#ae8ba676fb5528d220363edad0aeef1ff">EM_QUEUE_UNDEF</a></div><div class="ttdeci">#define EM_QUEUE_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00107">event_machine_types.h:107</a></div></div>
<div class="ttc" id="agroup__em__core_html_ga13d21af31382ec2c3d45010645707e9c"><div class="ttname"><a href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a></div><div class="ttdeci">int em_core_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/event__machine__core_8c_source.html#l00034">event_machine_core.c:34</a></div></div>
<div class="ttc" id="agroup__em__dispatcher_html_ga5883e134efdd392c8b792aba701d7cb0"><div class="ttname"><a href="../../d3/db8/group__em__dispatcher.html#ga5883e134efdd392c8b792aba701d7cb0">em_dispatch</a></div><div class="ttdeci">uint64_t em_dispatch(uint64_t rounds)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0d/event__machine__dispatcher_8c_source.html#l00040">event_machine_dispatcher.c:40</a></div></div>
<div class="ttc" id="agroup__em__eo_html_ga10cf8094caa56026eb0a402d3d22da23"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#ga10cf8094caa56026eb0a402d3d22da23">em_eo_remove_queue_all_sync</a></div><div class="ttdeci">em_status_t em_eo_remove_queue_all_sync(em_eo_t eo, int delete_queues)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00517">event_machine_eo.c:517</a></div></div>
<div class="ttc" id="agroup__em__eo_html_ga196c7caa1177575fd424e9a0d2854da6"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#ga196c7caa1177575fd424e9a0d2854da6">em_eo_create</a></div><div class="ttdeci">em_eo_t em_eo_create(const char *name, em_start_func_t start, em_start_local_func_t local_start, em_stop_func_t stop, em_stop_local_func_t local_stop, em_receive_func_t receive, const void *eo_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00040">event_machine_eo.c:40</a></div></div>
<div class="ttc" id="agroup__em__eo_html_ga3dabc55c5f2bdd1b46bfe4935979b87d"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#ga3dabc55c5f2bdd1b46bfe4935979b87d">em_eo_start</a></div><div class="ttdeci">em_status_t em_eo_start(em_eo_t eo, em_status_t *result, const em_eo_conf_t *conf, int num_notif, const em_notif_t notif_tbl[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00604">event_machine_eo.c:604</a></div></div>
<div class="ttc" id="agroup__em__eo_html_gac9b818edd466228b6fb653bd9337da3e"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#gac9b818edd466228b6fb653bd9337da3e">em_eo_add_queue_sync</a></div><div class="ttdeci">em_status_t em_eo_add_queue_sync(em_eo_t eo, em_queue_t queue)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00344">event_machine_eo.c:344</a></div></div>
<div class="ttc" id="agroup__em__eo_html_gadce026621953114bd26e5836d9693465"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#gadce026621953114bd26e5836d9693465">em_eo_stop_sync</a></div><div class="ttdeci">em_status_t em_eo_stop_sync(em_eo_t eo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00897">event_machine_eo.c:897</a></div></div>
<div class="ttc" id="agroup__em__eo_html_gae769b19e613b24487beb943cfb926977"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#gae769b19e613b24487beb943cfb926977">em_eo_delete</a></div><div class="ttdeci">em_status_t em_eo_delete(em_eo_t eo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00205">event_machine_eo.c:205</a></div></div>
<div class="ttc" id="agroup__em__eo_html_gae99c4891a050c3a51f946f3dc51de029"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#gae99c4891a050c3a51f946f3dc51de029">em_eo_remove_queue_sync</a></div><div class="ttdeci">em_status_t em_eo_remove_queue_sync(em_eo_t eo, em_queue_t queue)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00409">event_machine_eo.c:409</a></div></div>
<div class="ttc" id="agroup__em__error_html_gab6b469100e5f60670a742d944a6f530b"><div class="ttname"><a href="../../db/da0/group__em__error.html#gab6b469100e5f60670a742d944a6f530b">em_unregister_error_handler</a></div><div class="ttdeci">em_status_t em_unregister_error_handler(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/de9/event__machine__error_8c_source.html#l00050">event_machine_error.c:50</a></div></div>
<div class="ttc" id="agroup__em__error_html_gaf7332965c5deaa69411136e8d36089c6"><div class="ttname"><a href="../../db/da0/group__em__error.html#gaf7332965c5deaa69411136e8d36089c6">em_register_error_handler</a></div><div class="ttdeci">em_status_t em_register_error_handler(em_error_handler_t handler)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/de9/event__machine__error_8c_source.html#l00034">event_machine_error.c:34</a></div></div>
<div class="ttc" id="agroup__em__event__group_html_ga221c47c47f119b44eec0b0a85b7c11ed"><div class="ttname"><a href="../../d8/d4c/group__em__event__group.html#ga221c47c47f119b44eec0b0a85b7c11ed">em_event_group_delete</a></div><div class="ttdeci">em_status_t em_event_group_delete(em_event_group_t event_group)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd2/event__machine__event__group_8c_source.html#l00057">event_machine_event_group.c:57</a></div></div>
<div class="ttc" id="agroup__em__event__group_html_ga3088eff7f06c9d1c621a01eab3601fe5"><div class="ttname"><a href="../../d8/d4c/group__em__event__group.html#ga3088eff7f06c9d1c621a01eab3601fe5">em_event_group_is_ready</a></div><div class="ttdeci">int em_event_group_is_ready(em_event_group_t event_group)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd2/event__machine__event__group_8c_source.html#l00212">event_machine_event_group.c:212</a></div></div>
<div class="ttc" id="agroup__em__event__group_html_ga4119a66ac9ed21b11288602e6b68827a"><div class="ttname"><a href="../../d8/d4c/group__em__event__group.html#ga4119a66ac9ed21b11288602e6b68827a">em_event_group_get_notif</a></div><div class="ttdeci">int em_event_group_get_notif(em_event_group_t event_group, int max_notif, em_notif_t notif_tbl[])</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd2/event__machine__event__group_8c_source.html#l00735">event_machine_event_group.c:735</a></div></div>
<div class="ttc" id="agroup__em__event__group_html_ga59755895fbc8f370c6904610326b2594"><div class="ttname"><a href="../../d8/d4c/group__em__event__group.html#ga59755895fbc8f370c6904610326b2594">em_event_group_create</a></div><div class="ttdeci">em_event_group_t em_event_group_create(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd2/event__machine__event__group_8c_source.html#l00037">event_machine_event_group.c:37</a></div></div>
<div class="ttc" id="agroup__em__event__group_html_ga5b2619e0d19c4a958b06d5f15b652ba3"><div class="ttname"><a href="../../d8/d4c/group__em__event__group.html#ga5b2619e0d19c4a958b06d5f15b652ba3">em_event_group_abort</a></div><div class="ttdeci">em_status_t em_event_group_abort(em_event_group_t event_group)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd2/event__machine__event__group_8c_source.html#l00685">event_machine_event_group.c:685</a></div></div>
<div class="ttc" id="agroup__em__event__group_html_ga6dea07585453ebe66afad458dde5eec5"><div class="ttname"><a href="../../d8/d4c/group__em__event__group.html#ga6dea07585453ebe66afad458dde5eec5">em_event_group_apply</a></div><div class="ttdeci">em_status_t em_event_group_apply(em_event_group_t event_group, int count, int num_notif, const em_notif_t notif_tbl[])</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd2/event__machine__event__group_8c_source.html#l00093">event_machine_event_group.c:93</a></div></div>
<div class="ttc" id="agroup__em__event__group_html_gab1ecab5cd71642d3909ffb6a907fd9a5"><div class="ttname"><a href="../../d8/d4c/group__em__event__group.html#gab1ecab5cd71642d3909ffb6a907fd9a5">em_send_group</a></div><div class="ttdeci">em_status_t em_send_group(em_event_t event, em_queue_t queue, em_event_group_t event_group)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd2/event__machine__event__group_8c_source.html#l00474">event_machine_event_group.c:474</a></div></div>
<div class="ttc" id="agroup__em__event_html_ga5f0e40f1b0b4892ee16aafe07ba4c90c"><div class="ttname"><a href="../../d5/d33/group__em__event.html#ga5f0e40f1b0b4892ee16aafe07ba4c90c">em_alloc</a></div><div class="ttdeci">em_event_t em_alloc(uint32_t size, em_event_type_t type, em_pool_t pool)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d32/event__machine__event_8c_source.html#l00033">event_machine_event.c:33</a></div></div>
<div class="ttc" id="agroup__em__event_html_ga8f701c3a5901fc81d922b9d1d02691e3"><div class="ttname"><a href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a></div><div class="ttdeci">void * em_event_pointer(em_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d32/event__machine__event_8c_source.html#l00750">event_machine_event.c:750</a></div></div>
<div class="ttc" id="agroup__em__event_html_gaca4584a01b71429dfbb045342454b464"><div class="ttname"><a href="../../d5/d33/group__em__event.html#gaca4584a01b71429dfbb045342454b464">em_send</a></div><div class="ttdeci">em_status_t em_send(em_event_t event, em_queue_t queue)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d32/event__machine__event_8c_source.html#l00661">event_machine_event.c:661</a></div></div>
<div class="ttc" id="agroup__em__event_html_gad4f97ba217518d967f8078c56023c4d4"><div class="ttname"><a href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a></div><div class="ttdeci">void em_free(em_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d32/event__machine__event_8c_source.html#l00261">event_machine_event.c:261</a></div></div>
<div class="ttc" id="agroup__em__queue__group_html_ga0a861d268d820d2b6de1341749b4011a"><div class="ttname"><a href="../../d9/d01/group__em__queue__group.html#ga0a861d268d820d2b6de1341749b4011a">em_queue_group_get_mask</a></div><div class="ttdeci">em_status_t em_queue_group_get_mask(em_queue_group_t queue_group, em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd9/event__machine__queue__group_8c_source.html#l00260">event_machine_queue_group.c:260</a></div></div>
<div class="ttc" id="agroup__em__queue__group_html_ga17b2712720cfb7a5875ad21deb39b565"><div class="ttname"><a href="../../d9/d01/group__em__queue__group.html#ga17b2712720cfb7a5875ad21deb39b565">em_queue_group_find</a></div><div class="ttdeci">em_queue_group_t em_queue_group_find(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd9/event__machine__queue__group_8c_source.html#l00236">event_machine_queue_group.c:236</a></div></div>
<div class="ttc" id="agroup__em__queue__group_html_ga5660d6d2ae52d46a31a3de832a32be5d"><div class="ttname"><a href="../../d9/d01/group__em__queue__group.html#ga5660d6d2ae52d46a31a3de832a32be5d">em_queue_group_create</a></div><div class="ttdeci">em_queue_group_t em_queue_group_create(const char *name, const em_core_mask_t *mask, int num_notif, const em_notif_t notif_tbl[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd9/event__machine__queue__group_8c_source.html#l00040">event_machine_queue_group.c:40</a></div></div>
<div class="ttc" id="agroup__em__queue__group_html_ga59e3b34707a34f9be634f7b66c25a876"><div class="ttname"><a href="../../d9/d01/group__em__queue__group.html#ga59e3b34707a34f9be634f7b66c25a876">em_queue_group_modify</a></div><div class="ttdeci">em_status_t em_queue_group_modify(em_queue_group_t queue_group, const em_core_mask_t *new_mask, int num_notif, const em_notif_t notif_tbl[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd9/event__machine__queue__group_8c_source.html#l00161">event_machine_queue_group.c:161</a></div></div>
<div class="ttc" id="agroup__em__queue__group_html_gaa0231c3fa0532cd4b9d8ebada73c394e"><div class="ttname"><a href="../../d9/d01/group__em__queue__group.html#gaa0231c3fa0532cd4b9d8ebada73c394e">em_queue_group_delete</a></div><div class="ttdeci">em_status_t em_queue_group_delete(em_queue_group_t queue_group, int num_notif, const em_notif_t notif_tbl[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd9/event__machine__queue__group_8c_source.html#l00104">event_machine_queue_group.c:104</a></div></div>
<div class="ttc" id="agroup__em__queue_html_ga2a28907b18b348cbb153431c35af5752"><div class="ttname"><a href="../../de/d3c/group__em__queue.html#ga2a28907b18b348cbb153431c35af5752">em_queue_delete</a></div><div class="ttdeci">em_status_t em_queue_delete(em_queue_t queue)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dba/event__machine__queue_8c_source.html#l00095">event_machine_queue.c:95</a></div></div>
<div class="ttc" id="agroup__em__queue_html_ga83e001b62c2a87bf862fbf695c5e84fa"><div class="ttname"><a href="../../de/d3c/group__em__queue.html#ga83e001b62c2a87bf862fbf695c5e84fa">em_queue_set_context</a></div><div class="ttdeci">em_status_t em_queue_set_context(em_queue_t queue, const void *context)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dba/event__machine__queue_8c_source.html#l00112">event_machine_queue.c:112</a></div></div>
<div class="ttc" id="agroup__em__queue_html_gacab36f3033ecd8d67e56433605eb4648"><div class="ttname"><a href="../../de/d3c/group__em__queue.html#gacab36f3033ecd8d67e56433605eb4648">em_queue_get_group</a></div><div class="ttdeci">em_queue_group_t em_queue_get_group(em_queue_t queue)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dba/event__machine__queue_8c_source.html#l00215">event_machine_queue.c:215</a></div></div>
<div class="ttc" id="agroup__em__queue_html_gaef257858d1fa660524f198dba20fa9eb"><div class="ttname"><a href="../../de/d3c/group__em__queue.html#gaef257858d1fa660524f198dba20fa9eb">em_queue_create</a></div><div class="ttdeci">em_queue_t em_queue_create(const char *name, em_queue_type_t type, em_queue_prio_t prio, em_queue_group_t group, const em_queue_conf_t *conf)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dba/event__machine__queue_8c_source.html#l00041">event_machine_queue.c:41</a></div></div>
<div class="ttc" id="astruct__env__atomic32_html"><div class="ttname"><a href="../../dd/d03/struct__env__atomic32.html">_env_atomic32</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d11/env__atomic_8h_source.html#l00044">env_atomic.h:44</a></div></div>
<div class="ttc" id="astruct__env__atomic64_html"><div class="ttname"><a href="../../d5/dcc/struct__env__atomic64.html">_env_atomic64</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d11/env__atomic_8h_source.html#l00048">env_atomic.h:48</a></div></div>
<div class="ttc" id="astructem__core__mask__t_html"><div class="ttname"><a href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00242">event_machine_hw_types.h:242</a></div></div>
<div class="ttc" id="astructem__eo__conf__t_html"><div class="ttname"><a href="../../de/dc0/structem__eo__conf__t.html">em_eo_conf_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00242">event_machine_types.h:242</a></div></div>
<div class="ttc" id="astructem__notif__t_html"><div class="ttname"><a href="../../d8/db3/structem__notif__t.html">em_notif_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00268">event_machine_types.h:268</a></div></div>
<div class="ttc" id="astructem__notif__t_html_a1264d8b918729d1c703571289ea56f25"><div class="ttname"><a href="../../d8/db3/structem__notif__t.html#a1264d8b918729d1c703571289ea56f25">em_notif_t::queue</a></div><div class="ttdeci">em_queue_t queue</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00270">event_machine_types.h:270</a></div></div>
<div class="ttc" id="astructem__notif__t_html_a756240ca99311d0b6daf6d3b235aeb93"><div class="ttname"><a href="../../d8/db3/structem__notif__t.html#a756240ca99311d0b6daf6d3b235aeb93">em_notif_t::egroup</a></div><div class="ttdeci">em_event_group_t egroup</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00271">event_machine_types.h:271</a></div></div>
<div class="ttc" id="astructem__notif__t_html_af11de4e82ee78d6222a18ba93ffefa11"><div class="ttname"><a href="../../d8/db3/structem__notif__t.html#af11de4e82ee78d6222a18ba93ffefa11">em_notif_t::event</a></div><div class="ttdeci">em_event_t event</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00269">event_machine_types.h:269</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
  <div id="footer" class="tabs">
   <div class="headertitle"> 
     &copy; 2017 Nokia Networks
   </div>
  </div>
 </body>
</html>
