<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EM-ODP: scheduling_latency.c</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doc-stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EM-ODP
   &#160;<span id="projectnumber">3.8.0-1</span>
   </div>
   <div id="projectbrief">Event Machine on ODP</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/d3c/scheduling_latency_8c-example.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">scheduling_latency.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> *   Copyright (c) 2022, Nokia Solutions and Networks</span></div>
<div class="line"><span class="comment"> *   All rights reserved.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment"> *   modification, are permitted provided that the following conditions</span></div>
<div class="line"><span class="comment"> *   are met:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment"> *     * Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer in the</span></div>
<div class="line"><span class="comment"> *       documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><span class="comment"> *     * Neither the name of the copyright holder nor the names of its</span></div>
<div class="line"><span class="comment"> *       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment"> *       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment"> *   &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment"> *   A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment"> *   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment"> *   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment"> *   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment"> *   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment"> *   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment"> *   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @file</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Event Machine performance test for scheduling</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Measures time consumed during an event send-receive and/or achieved</span></div>
<div class="line"><span class="comment"> * throughout.</span></div>
<div class="line"><span class="comment"> * Command line arguments can be used to try different setups.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/mman.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdatomic.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d7/d5e/event__machine_8h.html">event_machine.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../de/d26/environment_8h.html">event_machine/platform/env/environment.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;cm_setup.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;cm_error_handler.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;scheduling_latency.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d5/d5d/event__machine__debug_8h.html">event_machine/helper/event_machine_debug.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> error_handler(em_eo_t eo, <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> error, <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0c0a929399ae33b615f8ca8018d2a69d">em_escope_t</a> escope, va_list args);</div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> start(<span class="keywordtype">void</span> *eo_context, em_eo_t eo, <span class="keyword">const</span> <a name="_a0"></a><a class="code" href="../../de/dc0/structem__eo__conf__t.html">em_eo_conf_t</a> *conf);</div>
<div class="line"><span class="keyword">static</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> stop(<span class="keywordtype">void</span> *eo_context, em_eo_t eo);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> receive_func(<span class="keywordtype">void</span> *eo_context, em_event_t event, <a class="code" href="../../d4/d11/event__machine__types_8h.html#a49fd700da185b0f64834bf967479a992">em_event_type_t</a> type,</div>
<div class="line">                         em_queue_t queue, <span class="keywordtype">void</span> *q_context);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> update_stats(int64_t ts, int64_t diff, uint64_t count);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_stats(int64_t start_time, int64_t loop_start_time, uint64_t count);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> parse_args(<span class="keywordtype">int</span> first, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> usage(<span class="keywordtype">void</span>);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> do_work(test_msg *msg);</div>
<div class="line"><span class="keyword">static</span> int64_t mask_from_str(<span class="keyword">const</span> <span class="keywordtype">char</span> *optarg, <a name="_a1"></a><a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> *mask);</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *queue_type_str(<a class="code" href="../../d4/d11/event__machine__types_8h.html#a47c0f0da93addf232d3d6b720f0bb262">em_queue_type_t</a> type);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> entry_hook(em_eo_t eo, <span class="keywordtype">void</span> **eo_ctx, em_event_t events[], <span class="keywordtype">int</span> num,</div>
<div class="line">                       em_queue_t *queue, <span class="keywordtype">void</span> **q_ctx);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> exit_hook(em_eo_t eo);</div>
<div class="line"><span class="keyword">static</span> uint64_t try_timestamp_overhead(<span class="keywordtype">void</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* data */</span></div>
<div class="line"><span class="keyword">static</span> perf_shm_t *perf_shm;</div>
<div class="line"><span class="keyword">static</span> __thread uint64_t entry_ts; <span class="comment">/* core local */</span></div>
<div class="line"><span class="keyword">static</span> __thread int64_t max_eo_time; <span class="comment">/* core local */</span></div>
<div class="line"> </div>
<div class="line">config_data g_options = {</div>
<div class="line">        .loops          = 1,</div>
<div class="line">        .queue_type     = <a name="a2"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032">EM_QUEUE_TYPE_ATOMIC</a>,</div>
<div class="line">        .lo_events      = 0,</div>
<div class="line">        .work_ns        = 2000,</div>
<div class="line">        .atomic_end     = <span class="keyword">false</span>,</div>
<div class="line">        .eo_receive     = <span class="keyword">false</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*************************************************************************/</span></div>
<div class="line"><span class="keywordtype">void</span> entry_hook(em_eo_t eo, <span class="keywordtype">void</span> **eo_ctx, em_event_t events[], <span class="keywordtype">int</span> num,</div>
<div class="line">                em_queue_t *queue, <span class="keywordtype">void</span> **q_ctx)</div>
<div class="line">{</div>
<div class="line">        (void)eo;</div>
<div class="line">        (void)eo_ctx;</div>
<div class="line">        (void)events;</div>
<div class="line">        (void)num;</div>
<div class="line">        (void)queue;</div>
<div class="line">        (void)q_ctx;</div>
<div class="line"> </div>
<div class="line">        entry_ts = odp_time_global_strict_ns();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> exit_hook(em_eo_t eo)</div>
<div class="line">{</div>
<div class="line">        (void)eo;</div>
<div class="line"> </div>
<div class="line">        int64_t diff = odp_time_global_strict_ns() - entry_ts;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (max_eo_time &lt; diff)</div>
<div class="line">                max_eo_time = diff;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *queue_type_str(<a class="code" href="../../d4/d11/event__machine__types_8h.html#a47c0f0da93addf232d3d6b720f0bb262">em_queue_type_t</a> type)</div>
<div class="line">{</div>
<div class="line">        <span class="keywordflow">switch</span> (type) {</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a3"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea">EM_QUEUE_TYPE_PARALLEL</a>:</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;PARALLEL&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a4"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa581ffa79b1fb6bbde9fcbaa99cb4a8f">EM_QUEUE_TYPE_PARALLEL_ORDERED</a>:</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;ORDERED&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032">EM_QUEUE_TYPE_ATOMIC</a>:</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;ATOMIC&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;?&gt;&quot;</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">int64_t mask_from_str(<span class="keyword">const</span> <span class="keywordtype">char</span> *hex, <a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> *cmask)</div>
<div class="line">{</div>
<div class="line">        uint64_t mask;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (hex == NULL)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">if</span> (sscanf(hex, <span class="stringliteral">&quot;%lx&quot;</span>, &amp;mask) != 1)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        <a name="a5"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#acddedd681d5375f6767615b90ee8563b">em_core_mask_set_bits</a>(&amp;mask, 1, cmask);</div>
<div class="line">        <span class="keywordflow">return</span> <a name="a6"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a>(cmask);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> update_stats(int64_t now, int64_t diff, uint64_t count)</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* dispatch time */</span></div>
<div class="line">        int64_t dtime = now - <a name="a7"></a><a class="code" href="../../d5/d5d/event__machine__debug_8h.html#a011ba8b3bb400ad6b17def7b8769b9dc">em_debug_timestamp</a>(EM_DEBUG_TSP_SCHED_RETURN) - perf_shm-&gt;ts_overhead;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* send-receive */</span></div>
<div class="line">        <span class="keywordflow">if</span> (diff &lt; perf_shm-&gt;times.mint) {</div>
<div class="line">                perf_shm-&gt;times.mint = diff;</div>
<div class="line">                perf_shm-&gt;times.minnum = count;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (diff &gt; perf_shm-&gt;times.maxt) {</div>
<div class="line">                perf_shm-&gt;times.maxt = diff;</div>
<div class="line">                perf_shm-&gt;times.maxnum = count;</div>
<div class="line">                perf_shm-&gt;times.maxdisp = dtime;</div>
<div class="line">        }</div>
<div class="line">        perf_shm-&gt;times.sum += diff;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* dispatch overhead min/max */</span></div>
<div class="line">        <span class="keywordflow">if</span> (dtime &lt; perf_shm-&gt;times.disp_min)</div>
<div class="line">                perf_shm-&gt;times.disp_min = dtime;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dtime &gt; perf_shm-&gt;times.disp_max)</div>
<div class="line">                perf_shm-&gt;times.disp_max = dtime;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* EO receive time. Only includes the timing event processing */</span></div>
<div class="line">        <span class="keywordflow">if</span> (g_options.eo_receive &amp;&amp; perf_shm-&gt;times.max_eo_time &lt; max_eo_time)</div>
<div class="line">                perf_shm-&gt;times.max_eo_time = max_eo_time;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> do_work(test_msg *msg)</div>
<div class="line">{</div>
<div class="line">        msg-&gt;count++;</div>
<div class="line">        <span class="keywordflow">if</span> (msg-&gt;work == 0)</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">        uint64_t t1 = odp_time_global_strict_ns();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* just loop for given time */</span></div>
<div class="line">        <span class="keywordflow">while</span> ((odp_time_global_ns() - t1) &lt; msg-&gt;work)</div>
<div class="line">                ;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> print_stats(int64_t start_time, int64_t loop_start_time, uint64_t count)</div>
<div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> period = (double)odp_time_global_ns() - loop_start_time;</div>
<div class="line">        <span class="keywordtype">double</span> runtime = (double)odp_time_global_ns() - start_time;</div>
<div class="line"> </div>
<div class="line">        period /= 1000000000; <span class="comment">/* sec */</span></div>
<div class="line">        runtime /= 1000000000;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">double</span> rate =  ((count - perf_shm-&gt;stat_mcount) / period) / 1000000; <span class="comment">/* M/sec */</span></div>
<div class="line">        uint64_t average = perf_shm-&gt;times.sum / (count - START_EVENTS);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d5d/event__machine__debug_8h.html#a011ba8b3bb400ad6b17def7b8769b9dc">em_debug_timestamp</a>(EM_DEBUG_TSP_SCHED_RETURN) == 0)</div>
<div class="line">                perf_shm-&gt;times.maxdisp = 0;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;: time(h) cores events(M) rate(M/s) min[ns] max[ns] avg[ns] min ev#     max ev#     max_do[ns] max_eo[ns]\n&quot;</span>);</div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;: %-7.3f %-5d %-9lu %-9.3f %-7lu %-7lu %-7lu %-11lu %-11lu %-10lu %lu\n&quot;</span>,</div>
<div class="line">                   runtime / (60 * 60), perf_shm-&gt;core_count, count / 1000000, rate,</div>
<div class="line">                   perf_shm-&gt;times.mint, perf_shm-&gt;times.maxt, average,</div>
<div class="line">                   perf_shm-&gt;times.minnum, perf_shm-&gt;times.maxnum,</div>
<div class="line">                   perf_shm-&gt;times.maxdisp, perf_shm-&gt;times.max_eo_time);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (g_options.lo_events) {</div>
<div class="line">                <span class="keywordtype">double</span> lrate = ((perf_shm-&gt;num_lo - perf_shm-&gt;stat_lcount) / period) / 1000000;</div>
<div class="line"> </div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;: bg events(M) rate(M/s)\n&quot;</span>);</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;: %-12.3f %.3f\n&quot;</span>, ((<span class="keywordtype">double</span>)perf_shm-&gt;num_lo) / 1000000, lrate);</div>
<div class="line">                perf_shm-&gt;stat_lcount = perf_shm-&gt;num_lo;</div>
<div class="line">        }</div>
<div class="line">        perf_shm-&gt;stat_mcount = count;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> usage(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;scheduling_latency %s\n\n%s&quot;</span>, VERSION, instructions);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; ; i++) {</div>
<div class="line">                <span class="keywordflow">if</span> (longopts[i].name == NULL)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;-%c or --%-16s %s\n&quot;</span>, longopts[i].val, longopts[i].name, descopts[i]);</div>
<div class="line">        }</div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> parse_args(<span class="keywordtype">int</span> first, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">        <a name="a8"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#af950c0bca4c115cd0896785d2a138979">em_core_mask_zero</a>(&amp;g_options.hgroup);</div>
<div class="line">        <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#af950c0bca4c115cd0896785d2a138979">em_core_mask_zero</a>(&amp;g_options.lgroup);</div>
<div class="line"> </div>
<div class="line">        optind = first + 1; <span class="comment">/* skip &#39;--&#39; */</span></div>
<div class="line">        <span class="keywordflow">while</span> (1) {</div>
<div class="line">                <span class="keywordtype">int</span> opt;</div>
<div class="line">                <span class="keywordtype">int</span> long_index;</div>
<div class="line">                <span class="keywordtype">char</span> *endptr;</div>
<div class="line">                int64_t num;</div>
<div class="line"> </div>
<div class="line">                opt = getopt_long(argc, argv, shortopts, longopts, &amp;long_index);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (opt == -1)</div>
<div class="line">                        <span class="keywordflow">break</span>;  <span class="comment">/* No more options */</span></div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">switch</span> (opt) {</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>: {</div>
<div class="line">                        g_options.atomic_end = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>: {</div>
<div class="line">                        g_options.eo_receive = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>: {</div>
<div class="line">                        num = strtol(optarg, &amp;endptr, 0);</div>
<div class="line">                        <span class="keywordflow">if</span> (*endptr != <span class="charliteral">&#39;\0&#39;</span> || num &lt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                        g_options.loops = (uint64_t)num;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;q&#39;</span>: {</div>
<div class="line">                        num = strtol(optarg, &amp;endptr, 0);</div>
<div class="line">                        <span class="keywordflow">if</span> (*endptr != <span class="charliteral">&#39;\0&#39;</span> || num &lt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                        <span class="keywordflow">switch</span> (num) {</div>
<div class="line">                        <span class="keywordflow">case</span> 0:</div>
<div class="line">                                g_options.queue_type = <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea">EM_QUEUE_TYPE_PARALLEL</a>;</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> 1:</div>
<div class="line">                                g_options.queue_type = <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032">EM_QUEUE_TYPE_ATOMIC</a>;</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> 2:</div>
<div class="line">                                g_options.queue_type = <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa581ffa79b1fb6bbde9fcbaa99cb4a8f">EM_QUEUE_TYPE_PARALLEL_ORDERED</a>;</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>: {</div>
<div class="line">                        num = strtol(optarg, &amp;endptr, 0);</div>
<div class="line">                        <span class="keywordflow">if</span> (*endptr != <span class="charliteral">&#39;\0&#39;</span> || num &lt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                        g_options.lo_events = (uint64_t)num;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>: {</div>
<div class="line">                        num = strtol(optarg, &amp;endptr, 0);</div>
<div class="line">                        <span class="keywordflow">if</span> (*endptr != <span class="charliteral">&#39;\0&#39;</span> || num &lt; 0)</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                        g_options.work_ns = (uint64_t)num;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>: { <span class="comment">/* low-prio grp */</span></div>
<div class="line">                        num = mask_from_str(optarg, &amp;g_options.lgroup);</div>
<div class="line">                        <span class="keywordflow">if</span> (!num)</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>: { <span class="comment">/* hi-prio grp */</span></div>
<div class="line">                        num = mask_from_str(optarg, &amp;g_options.hgroup);</div>
<div class="line">                        <span class="keywordflow">if</span> (!num)</div>
<div class="line">                                <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        opterr = 0;</div>
<div class="line">                        usage();</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        optind = 1; <span class="comment">/* cm_setup() to parse again */</span></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> error_handler(em_eo_t eo, <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> error, <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0c0a929399ae33b615f8ca8018d2a69d">em_escope_t</a> escope, va_list args)</div>
<div class="line">{</div>
<div class="line">        <span class="keywordflow">return</span> test_error_handler(eo, error, escope, args);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_init(<span class="keyword">const</span> appl_conf_t *appl_conf)</div>
<div class="line">{</div>
<div class="line">        (void)appl_conf;</div>
<div class="line">        <span class="keywordtype">int</span> core = <a name="a9"></a><a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (core == 0) {</div>
<div class="line">                perf_shm = env_shared_reserve(<span class="stringliteral">&quot;PerfSharedMem&quot;</span>, <span class="keyword">sizeof</span>(perf_shm_t));</div>
<div class="line">                <a name="a10"></a><a class="code" href="../../db/da0/group__em__error.html#gaf7332965c5deaa69411136e8d36089c6">em_register_error_handler</a>(error_handler);</div>
<div class="line">                mlockall(MCL_FUTURE); <span class="comment">/* make sure all memory is mapped at start */</span></div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                perf_shm = env_shared_lookup(<span class="stringliteral">&quot;PerfSharedMem&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (perf_shm == NULL)</div>
<div class="line">                test_error(<a name="a11"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a>(0xec0de), 0xdead,</div>
<div class="line">                           <span class="stringliteral">&quot;Test init failed on EM-core: %u\n&quot;</span>,</div>
<div class="line">                           core);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (core == 0) {</div>
<div class="line">                memset(perf_shm, 0, <span class="keyword">sizeof</span>(perf_shm_t));</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;%luB Shared memory initialized\n&quot;</span>, <span class="keyword">sizeof</span>(perf_shm_t));</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">uint64_t try_timestamp_overhead(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define NUM_TS_TRY 5</span></div>
<div class="line">        uint64_t oh = UINT64_MAX;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* measure time stamping overhead, take min */</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NUM_TS_TRY; i++) {</div>
<div class="line">                uint64_t t1 = odp_time_global_ns();</div>
<div class="line">                uint64_t t2 = odp_time_global_ns();</div>
<div class="line">                uint64_t t3 = odp_time_global_ns();</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (t2 - t1 &lt; oh)</div>
<div class="line">                        oh = t2 - t1;</div>
<div class="line">                <span class="keywordflow">if</span> (t3 - t2 &lt; oh)</div>
<div class="line">                        oh = t3 - t2;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> oh;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_start(<span class="keyword">const</span> appl_conf_t *appl_conf)</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* Store the number of EM-cores running the application */</span></div>
<div class="line">        perf_shm-&gt;core_count = appl_conf-&gt;core_count;</div>
<div class="line"> </div>
<div class="line">        perf_shm-&gt;ts_overhead = (int64_t)try_timestamp_overhead();</div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;odp_time_global_ns pair overhead seems to be %lu ns\n&quot;</span>, perf_shm-&gt;ts_overhead);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create EO */</span></div>
<div class="line">        perf_shm-&gt;eo = <a name="a12"></a><a class="code" href="../../d8/d5f/group__em__eo.html#ga196c7caa1177575fd424e9a0d2854da6">em_eo_create</a>(<span class="stringliteral">&quot;perf test eo&quot;</span>, start, NULL, stop, NULL, receive_func,</div>
<div class="line">                                    &amp;perf_shm-&gt;eo_ctx);</div>
<div class="line">        test_fatal_if(perf_shm-&gt;eo == <a name="a13"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#af28fb8daf62b942ced417e158ed7e1c7">EM_EO_UNDEF</a>, <span class="stringliteral">&quot;EO create failed&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Queues */</span></div>
<div class="line">        em_queue_group_t grp = <a name="a14"></a><a class="code" href="../../db/d6d/event__machine__hw__config_8h.html#ae56af1c575498ec19f0836ee916d0eb9">EM_QUEUE_GROUP_DEFAULT</a>;</div>
<div class="line">        <span class="keywordtype">char</span> buf[32];</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;Using queue type %d (%s) for timing\n&quot;</span>,</div>
<div class="line">                   (<span class="keywordtype">int</span>)g_options.queue_type, queue_type_str(g_options.queue_type));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a>(&amp;g_options.hgroup)) { <span class="comment">/* separate queue group for timing */</span></div>
<div class="line">                grp = <a name="a15"></a><a class="code" href="../../d9/d01/group__em__queue__group.html#ga6f3e8e31f260f65abc902aad59c4497d">em_queue_group_create_sync</a>(<span class="stringliteral">&quot;HGRP&quot;</span>, &amp;g_options.hgroup);</div>
<div class="line">                test_fatal_if(grp == <a name="a16"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a3f2bef96eaf8b2855699d6adee7758f4">EM_QUEUE_GROUP_UNDEF</a>, <span class="stringliteral">&quot;Can&#39;t create hi-prio queue group!&quot;</span>);</div>
<div class="line">                <a name="a17"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a>(buf, 32, &amp;g_options.hgroup);</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Coremask for hi-prio events: %s (%d cores)\n&quot;</span>,</div>
<div class="line">                           buf, <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a>(&amp;g_options.hgroup));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Using default queue group for hi-prio\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        em_queue_t q = <a name="a18"></a><a class="code" href="../../de/d3c/group__em__queue.html#gaef257858d1fa660524f198dba20fa9eb">em_queue_create</a>(<span class="stringliteral">&quot;testQ&quot;</span>, g_options.queue_type,</div>
<div class="line">                                       <a name="a19"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a8171ccd1b7a0df99a6c7d0f3ec82e52fa621ca7c9a90044e11dad3060006dc450">EM_QUEUE_PRIO_HIGHEST</a>, grp, NULL);</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(q == <a name="a20"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#ae8ba676fb5528d220363edad0aeef1ff">EM_QUEUE_UNDEF</a>, <span class="stringliteral">&quot;Q create fail&quot;</span>);</div>
<div class="line">        <a name="a21"></a><a class="code" href="../../d8/d5f/group__em__eo.html#gac9b818edd466228b6fb653bd9337da3e">em_eo_add_queue_sync</a>(perf_shm-&gt;eo, q);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Low priority background work queue */</span></div>
<div class="line">        grp = <a class="code" href="../../db/d6d/event__machine__hw__config_8h.html#ae56af1c575498ec19f0836ee916d0eb9">EM_QUEUE_GROUP_DEFAULT</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a>(&amp;g_options.lgroup)) { <span class="comment">/* separate queue group for background */</span></div>
<div class="line">                grp = <a class="code" href="../../d9/d01/group__em__queue__group.html#ga6f3e8e31f260f65abc902aad59c4497d">em_queue_group_create_sync</a>(<span class="stringliteral">&quot;LGRP&quot;</span>, &amp;g_options.lgroup);</div>
<div class="line">                test_fatal_if(grp == <a class="code" href="../../d4/d11/event__machine__types_8h.html#a3f2bef96eaf8b2855699d6adee7758f4">EM_QUEUE_GROUP_UNDEF</a>, <span class="stringliteral">&quot;Can&#39;t create lower-prio queue group!&quot;</span>);</div>
<div class="line">                <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a>(buf, 32, &amp;g_options.lgroup);</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Coremask for background events: %s (%d cores)\n&quot;</span>,</div>
<div class="line">                           buf, <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a>(&amp;g_options.lgroup));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Using default queue group for background events\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a>(&amp;g_options.lgroup) &amp;&amp; <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a>(&amp;g_options.hgroup)) {</div>
<div class="line">                <a class="code" href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a> mask;</div>
<div class="line"> </div>
<div class="line">                <a name="a22"></a><a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#ac36c94bc9530a3f0341b85f25a5aa01b">em_core_mask_and</a>(&amp;mask, &amp;g_options.lgroup, &amp;g_options.hgroup);</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Queue groups are %soverlapping\n&quot;</span>, <a class="code" href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a>(&amp;mask) ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;not &quot;</span>);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Queue groups are overlapping\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        em_queue_t q2 = <a class="code" href="../../de/d3c/group__em__queue.html#gaef257858d1fa660524f198dba20fa9eb">em_queue_create</a>(<span class="stringliteral">&quot;testQlo&quot;</span>, <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea">EM_QUEUE_TYPE_PARALLEL</a>, <a name="a23"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a8171ccd1b7a0df99a6c7d0f3ec82e52fa2311aaab5842cd6b78e4587be0fbf0ca">EM_QUEUE_PRIO_NORMAL</a>,</div>
<div class="line">                                        grp, NULL);</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(q2 == <a class="code" href="../../d4/d11/event__machine__types_8h.html#ae8ba676fb5528d220363edad0aeef1ff">EM_QUEUE_UNDEF</a>, <span class="stringliteral">&quot;Q create fail&quot;</span>);</div>
<div class="line">        <a class="code" href="../../d8/d5f/group__em__eo.html#gac9b818edd466228b6fb653bd9337da3e">em_eo_add_queue_sync</a>(perf_shm-&gt;eo, q2);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (g_options.lo_events)</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Background work: %lu normal priority events with %.2fus work\n&quot;</span>,</div>
<div class="line">                           g_options.lo_events, g_options.work_ns / 1000.0);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (g_options.atomic_end)</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Using atomic_processing_end()\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (g_options.eo_receive) {</div>
<div class="line">                <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> stat = <a name="a24"></a><a class="code" href="../../d3/db8/group__em__dispatcher.html#ga50a0ef57733fbe0bf06ccfd0e3c2a665">em_dispatch_register_enter_cb</a>(entry_hook);</div>
<div class="line"> </div>
<div class="line">                test_fatal_if(stat != <a name="a25"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>, <span class="stringliteral">&quot;entry_hook() register failed!&quot;</span>);</div>
<div class="line">                stat = <a name="a26"></a><a class="code" href="../../d3/db8/group__em__dispatcher.html#ga867519ecfc13f60713d54b419cdc2f25">em_dispatch_register_exit_cb</a>(exit_hook);</div>
<div class="line">                test_fatal_if(stat != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>, <span class="stringliteral">&quot;exit_hook() register failed!&quot;</span>);</div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;entry/exit hooks registered (expect a bit more latency)\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Start EOs */</span></div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> start_ret = <a name="a27"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#a740919266fbb41b8a8127a9ef215eea0afac5dceb8d327a1cbff66cdfa3a93a81">EM_ERR</a>, ret;</div>
<div class="line"> </div>
<div class="line">        perf_shm-&gt;eo_ctx.test_q = q;</div>
<div class="line">        perf_shm-&gt;eo_ctx.loprio_q = q2;</div>
<div class="line">        perf_shm-&gt;eo_ctx.stopping = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">        ret = <a name="a28"></a><a class="code" href="../../d8/d5f/group__em__eo.html#gabe4f7a789ec9523367c086793061562d">em_eo_start_sync</a>(perf_shm-&gt;eo, &amp;start_ret, NULL);</div>
<div class="line">        test_fatal_if(ret != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a> || start_ret != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;EO start:%&quot;</span> PRI_STAT <span class="stringliteral">&quot; %&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, ret, start_ret);</div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;Starting %lu loops\n&quot;</span>, g_options.loops);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_stop(<span class="keyword">const</span> appl_conf_t *appl_conf)</div>
<div class="line">{</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> core = <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>();</div>
<div class="line">        em_eo_t eo;</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> ret;</div>
<div class="line"> </div>
<div class="line">        (void)appl_conf;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;%s() on EM-core %d\n&quot;</span>, __func__, core);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Stop EOs */</span></div>
<div class="line">        eo = perf_shm-&gt;eo;</div>
<div class="line">        ret = <a name="a29"></a><a class="code" href="../../d8/d5f/group__em__eo.html#gadce026621953114bd26e5836d9693465">em_eo_stop_sync</a>(eo);</div>
<div class="line">        test_fatal_if(ret != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;EO:%&quot;</span> <a name="a30"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot; stop:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, eo, ret);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Remove and delete all of the EO&#39;s queues, then delete the EO */</span></div>
<div class="line">        eo = perf_shm-&gt;eo;</div>
<div class="line">        ret = <a name="a31"></a><a class="code" href="../../d8/d5f/group__em__eo.html#ga10cf8094caa56026eb0a402d3d22da23">em_eo_remove_queue_all_sync</a>(eo, <a name="a32"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a419c8373b72a8c5ed1c3e3ded3e262e0">EM_TRUE</a>);</div>
<div class="line">        test_fatal_if(ret != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;EO remove queue all:%&quot;</span> PRI_STAT <span class="stringliteral">&quot; EO:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot;&quot;</span>, ret, eo);</div>
<div class="line">        ret = <a name="a33"></a><a class="code" href="../../d8/d5f/group__em__eo.html#gae769b19e613b24487beb943cfb926977">em_eo_delete</a>(eo);</div>
<div class="line">        test_fatal_if(ret != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;EO:%&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot; delete:%&quot;</span> PRI_STAT <span class="stringliteral">&quot;&quot;</span>, eo, ret);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_term(<span class="keyword">const</span> appl_conf_t *appl_conf)</div>
<div class="line">{</div>
<div class="line">        (void)appl_conf;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;%s() on EM-core %d\n&quot;</span>, __func__, <a class="code" href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a>());</div>
<div class="line">        <a name="a34"></a><a class="code" href="../../db/da0/group__em__error.html#gab6b469100e5f60670a742d944a6f530b">em_unregister_error_handler</a>();</div>
<div class="line">        env_shared_free(perf_shm);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> start(<span class="keywordtype">void</span> *eo_context, em_eo_t eo, <span class="keyword">const</span> <a class="code" href="../../de/dc0/structem__eo__conf__t.html">em_eo_conf_t</a> *conf)</div>
<div class="line">{</div>
<div class="line">        (void)conf;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;EO %&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot; starting\n&quot;</span>, eo);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d5d/event__machine__debug_8h.html#a011ba8b3bb400ad6b17def7b8769b9dc">em_debug_timestamp</a>(EM_DEBUG_TSP_SCHED_RETURN) == 0) <span class="comment">/* could be disabled */</span></div>
<div class="line">                APPL_PRINT(<span class="stringliteral">&quot;Dispatch timestamps (max_do) NOT available\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (uint64_t i = 0; i &lt; g_options.lo_events; i++) {</div>
<div class="line">                em_event_t ev = <a name="a35"></a><a class="code" href="../../d5/d33/group__em__event.html#ga5f0e40f1b0b4892ee16aafe07ba4c90c">em_alloc</a>(<span class="keyword">sizeof</span>(test_msg), <a name="a36"></a><a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1">EM_EVENT_TYPE_SW</a>, <a name="a37"></a><a class="code" href="../../db/d6d/event__machine__hw__config_8h.html#aaa0a290a45f4b1280f3330fadde6bfde">EM_POOL_DEFAULT</a>);</div>
<div class="line"> </div>
<div class="line">                test_fatal_if(ev == <a name="a38"></a><a class="code" href="../../d4/d11/event__machine__types_8h.html#a8542d9c2c9a29e35ff042b1d59cc479b">EM_EVENT_UNDEF</a>, <span class="stringliteral">&quot;Event alloc fail&quot;</span>);</div>
<div class="line">                test_msg *msg = <a name="a39"></a><a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(ev);</div>
<div class="line"> </div>
<div class="line">                msg-&gt;count = 0;</div>
<div class="line">                msg-&gt;work = g_options.work_ns;</div>
<div class="line">                msg-&gt;magic = BACKGROUND_MAGIC;</div>
<div class="line">                <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> ret = <a name="a40"></a><a class="code" href="../../d5/d33/group__em__event.html#gaca4584a01b71429dfbb045342454b464">em_send</a>(ev, ((app_eo_ctx *)eo_context)-&gt;loprio_q);</div>
<div class="line"> </div>
<div class="line">                test_fatal_if(ret != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>, <span class="stringliteral">&quot;Send fail&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;Sent %lu bg events\n&quot;</span>, g_options.lo_events);</div>
<div class="line"> </div>
<div class="line">        perf_shm-&gt;times.mint = INT64_MAX;</div>
<div class="line">        perf_shm-&gt;times.disp_min = INT64_MAX;</div>
<div class="line"> </div>
<div class="line">        em_event_t ev = <a class="code" href="../../d5/d33/group__em__event.html#ga5f0e40f1b0b4892ee16aafe07ba4c90c">em_alloc</a>(<span class="keyword">sizeof</span>(test_msg), <a class="code" href="../../d0/d07/event__machine__hw__types_8h.html#ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1">EM_EVENT_TYPE_SW</a>, <a class="code" href="../../db/d6d/event__machine__hw__config_8h.html#aaa0a290a45f4b1280f3330fadde6bfde">EM_POOL_DEFAULT</a>);</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(ev == <a class="code" href="../../d4/d11/event__machine__types_8h.html#a8542d9c2c9a29e35ff042b1d59cc479b">EM_EVENT_UNDEF</a>, <span class="stringliteral">&quot;Event alloc fail&quot;</span>);</div>
<div class="line">        test_msg *msg = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(ev);</div>
<div class="line"> </div>
<div class="line">        msg-&gt;count = 0;</div>
<div class="line">        msg-&gt;magic = TIMING_MAGIC;</div>
<div class="line">        msg-&gt;ts = odp_time_global_ns();</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../d5/d33/group__em__event.html#gaca4584a01b71429dfbb045342454b464">em_send</a>(ev, ((app_eo_ctx *)eo_context)-&gt;test_q);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> stop(<span class="keywordtype">void</span> *eo_context, em_eo_t eo)</div>
<div class="line">{</div>
<div class="line">        (void)eo_context;</div>
<div class="line"> </div>
<div class="line">        APPL_PRINT(<span class="stringliteral">&quot;EO %&quot;</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a> <span class="stringliteral">&quot; stopping\n&quot;</span>, eo);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> receive_func(<span class="keywordtype">void</span> *eo_context, em_event_t event, <a class="code" href="../../d4/d11/event__machine__types_8h.html#a49fd700da185b0f64834bf967479a992">em_event_type_t</a> type,</div>
<div class="line">                  em_queue_t queue, <span class="keywordtype">void</span> *q_context)</div>
<div class="line">{</div>
<div class="line">        uint64_t ts_ns = odp_time_global_strict_ns(); <span class="comment">/* first thing to do*/</span></div>
<div class="line">        app_eo_ctx *ctx = (app_eo_ctx *)eo_context;</div>
<div class="line">        test_msg *msg = <a class="code" href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a>(event);</div>
<div class="line">        <a class="code" href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a> ret;</div>
<div class="line"> </div>
<div class="line">        (void)type;</div>
<div class="line">        (void)q_context;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* shutdown? */</span></div>
<div class="line">        <span class="keywordflow">if</span> (unlikely(ctx-&gt;stopping)) {</div>
<div class="line">                <a name="a41"></a><a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(event);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* background work? */</span></div>
<div class="line">        <span class="keywordflow">if</span> (unlikely(queue == ctx-&gt;loprio_q)) {</div>
<div class="line">                do_work(msg);</div>
<div class="line">                perf_shm-&gt;num_lo++; <span class="comment">/* atomic_uint */</span></div>
<div class="line">                ret = <a class="code" href="../../d5/d33/group__em__event.html#gaca4584a01b71429dfbb045342454b464">em_send</a>(event, ctx-&gt;loprio_q);</div>
<div class="line">                test_fatal_if(ret != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>, <span class="stringliteral">&quot;Event send fail, ret=%u, #=%lu&quot;</span>,</div>
<div class="line">                              (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)ret, msg-&gt;count);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        test_fatal_if(msg-&gt;magic != TIMING_MAGIC, <span class="stringliteral">&quot;Unexpected event, magic fail (%x/%x)&quot;</span>,</div>
<div class="line">                      msg-&gt;magic, TIMING_MAGIC);</div>
<div class="line">        test_fatal_if(queue != ctx-&gt;test_q, <span class="stringliteral">&quot;Timing event from wrong Q??&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* timing event, maintain min/max/avg latency */</span></div>
<div class="line">        int64_t diff = ts_ns - msg-&gt;ts - perf_shm-&gt;ts_overhead;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (unlikely(msg-&gt;count &lt; START_EVENTS)) { <span class="comment">/* ignore first ones */</span></div>
<div class="line">                perf_shm-&gt;start_time = odp_time_global_ns();</div>
<div class="line">                perf_shm-&gt;loop_start_time = perf_shm-&gt;start_time;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                update_stats(ts_ns, diff, msg-&gt;count);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (g_options.atomic_end)</div>
<div class="line">                        <a name="a42"></a><a class="code" href="../../dd/d1b/group__em__scheduler.html#gaf80e7173968f134ff3a9df6509c17009">em_atomic_processing_end</a>();</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* reporting period */</span></div>
<div class="line">                <span class="keywordflow">if</span> (unlikely(!(msg-&gt;count % REPORT_PERIOD) &amp;&amp; msg-&gt;count)) {</div>
<div class="line">                        print_stats(perf_shm-&gt;start_time, perf_shm-&gt;loop_start_time, msg-&gt;count);</div>
<div class="line">                        perf_shm-&gt;loopcount++;</div>
<div class="line">                        <span class="keywordflow">if</span> (perf_shm-&gt;loopcount &gt;= g_options.loops &amp;&amp; g_options.loops) {</div>
<div class="line">                                ctx-&gt;stopping = <span class="keyword">true</span>;</div>
<div class="line">                                <a class="code" href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a>(event);</div>
<div class="line">                                <span class="keyword">raise</span>(SIGINT);</div>
<div class="line">                                <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        perf_shm-&gt;loop_start_time = odp_time_global_ns();</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        msg-&gt;count++;</div>
<div class="line">        msg-&gt;ts = odp_time_global_strict_ns();</div>
<div class="line">        ret = <a class="code" href="../../d5/d33/group__em__event.html#gaca4584a01b71429dfbb045342454b464">em_send</a>(event, ctx-&gt;test_q);</div>
<div class="line">        test_fatal_if(ret != <a class="code" href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a>, <span class="stringliteral">&quot;Event send fail&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* pick app-specific arguments after &#39;--&#39; */</span></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++) {</div>
<div class="line">                <span class="keywordflow">if</span> (!strcmp(argv[i], <span class="stringliteral">&quot;--&quot;</span>))</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (i &lt; argc) {</div>
<div class="line">                <span class="keywordflow">if</span> (!parse_args(i, argc, argv)) {</div>
<div class="line">                        APPL_PRINT(<span class="stringliteral">&quot;Invalid application arguments\n&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> cm_setup(argc, argv);</div>
<div class="line">}</div>
<div class="ttc" id="aenvironment_8h_html"><div class="ttname"><a href="../../de/d26/environment_8h.html">environment.h</a></div></div>
<div class="ttc" id="aevent__machine_8h_html"><div class="ttname"><a href="../../d7/d5e/event__machine_8h.html">event_machine.h</a></div></div>
<div class="ttc" id="aevent__machine__debug_8h_html"><div class="ttname"><a href="../../d5/d5d/event__machine__debug_8h.html">event_machine_debug.h</a></div></div>
<div class="ttc" id="aevent__machine__debug_8h_html_a011ba8b3bb400ad6b17def7b8769b9dc"><div class="ttname"><a href="../../d5/d5d/event__machine__debug_8h.html#a011ba8b3bb400ad6b17def7b8769b9dc">em_debug_timestamp</a></div><div class="ttdeci">uint64_t em_debug_timestamp(em_debug_tsp_t tsp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddf/event__machine__helper_8c_source.html#l00129">event_machine_helper.c:129</a></div></div>
<div class="ttc" id="aevent__machine__hw__config_8h_html_aaa0a290a45f4b1280f3330fadde6bfde"><div class="ttname"><a href="../../db/d6d/event__machine__hw__config_8h.html#aaa0a290a45f4b1280f3330fadde6bfde">EM_POOL_DEFAULT</a></div><div class="ttdeci">#define EM_POOL_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6d/event__machine__hw__config_8h_source.html#l00191">event_machine_hw_config.h:191</a></div></div>
<div class="ttc" id="aevent__machine__hw__config_8h_html_ae56af1c575498ec19f0836ee916d0eb9"><div class="ttname"><a href="../../db/d6d/event__machine__hw__config_8h.html#ae56af1c575498ec19f0836ee916d0eb9">EM_QUEUE_GROUP_DEFAULT</a></div><div class="ttdeci">#define EM_QUEUE_GROUP_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d6d/event__machine__hw__config_8h_source.html#l00147">event_machine_hw_config.h:147</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_a1bcd7c8b8af8004f8e9a37f25532ac15"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bcd7c8b8af8004f8e9a37f25532ac15">em_core_mask_count</a></div><div class="ttdeci">int em_core_mask_count(const em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00087">event_machine_hw_specific.c:87</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_a1bfd8374018370719836fe74ad91d3ee"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#a1bfd8374018370719836fe74ad91d3ee">em_core_mask_tostr</a></div><div class="ttdeci">void em_core_mask_tostr(char *mask_str, int len, const em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00156">event_machine_hw_specific.c:156</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_ac36c94bc9530a3f0341b85f25a5aa01b"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#ac36c94bc9530a3f0341b85f25a5aa01b">em_core_mask_and</a></div><div class="ttdeci">void em_core_mask_and(em_core_mask_t *dst, const em_core_mask_t *src1, const em_core_mask_t *src2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00181">event_machine_hw_specific.c:181</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_acddedd681d5375f6767615b90ee8563b"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#acddedd681d5375f6767615b90ee8563b">em_core_mask_set_bits</a></div><div class="ttdeci">void em_core_mask_set_bits(const uint64_t bits[], int len, em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00092">event_machine_hw_specific.c:92</a></div></div>
<div class="ttc" id="aevent__machine__hw__specific_8h_html_af950c0bca4c115cd0896785d2a138979"><div class="ttname"><a href="../../d3/d7b/event__machine__hw__specific_8h.html#af950c0bca4c115cd0896785d2a138979">em_core_mask_zero</a></div><div class="ttdeci">void em_core_mask_zero(em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d26/event__machine__hw__specific_8c_source.html#l00043">event_machine_hw_specific.c:43</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965a43e0ef6f7a63caf0b225a52412ef3032">EM_QUEUE_TYPE_ATOMIC</a></div><div class="ttdeci">@ EM_QUEUE_TYPE_ATOMIC</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00112">event_machine_hw_types.h:112</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa3f46c70193d0a7d9bb8fc149a3179ea">EM_QUEUE_TYPE_PARALLEL</a></div><div class="ttdeci">@ EM_QUEUE_TYPE_PARALLEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00117">event_machine_hw_types.h:117</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a368b59e8c18f57c4034420e3ba44e965aa581ffa79b1fb6bbde9fcbaa99cb4a8f"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a368b59e8c18f57c4034420e3ba44e965aa581ffa79b1fb6bbde9fcbaa99cb4a8f">EM_QUEUE_TYPE_PARALLEL_ORDERED</a></div><div class="ttdeci">@ EM_QUEUE_TYPE_PARALLEL_ORDERED</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00122">event_machine_hw_types.h:122</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a740919266fbb41b8a8127a9ef215eea0afac5dceb8d327a1cbff66cdfa3a93a81"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a740919266fbb41b8a8127a9ef215eea0afac5dceb8d327a1cbff66cdfa3a93a81">EM_ERR</a></div><div class="ttdeci">@ EM_ERR</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00313">event_machine_hw_types.h:312</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a8171ccd1b7a0df99a6c7d0f3ec82e52fa2311aaab5842cd6b78e4587be0fbf0ca"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a8171ccd1b7a0df99a6c7d0f3ec82e52fa2311aaab5842cd6b78e4587be0fbf0ca">EM_QUEUE_PRIO_NORMAL</a></div><div class="ttdeci">@ EM_QUEUE_PRIO_NORMAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00153">event_machine_hw_types.h:153</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_a8171ccd1b7a0df99a6c7d0f3ec82e52fa621ca7c9a90044e11dad3060006dc450"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#a8171ccd1b7a0df99a6c7d0f3ec82e52fa621ca7c9a90044e11dad3060006dc450">EM_QUEUE_PRIO_HIGHEST</a></div><div class="ttdeci">@ EM_QUEUE_PRIO_HIGHEST</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00156">event_machine_hw_types.h:155</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_ac341b7db29d8127e864a45c9bd2a4aa3"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#ac341b7db29d8127e864a45c9bd2a4aa3">EM_ERROR_SET_FATAL</a></div><div class="ttdeci">#define EM_ERROR_SET_FATAL(error)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00428">event_machine_hw_types.h:428</a></div></div>
<div class="ttc" id="aevent__machine__hw__types_8h_html_ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1"><div class="ttname"><a href="../../d0/d07/event__machine__hw__types_8h.html#ace0fe27049350469ff1be8188acfea89a2066feedf79f96d10ce9215fa5f37db1">EM_EVENT_TYPE_SW</a></div><div class="ttdeci">@ EM_EVENT_TYPE_SW</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00072">event_machine_hw_types.h:72</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a03546e6a7e93665c52d479831e0a6dca"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a03546e6a7e93665c52d479831e0a6dca">EM_OK</a></div><div class="ttdeci">#define EM_OK</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00329">event_machine_types.h:329</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a0bf4a25d46e18ee918e684e5deb27fa4"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a0bf4a25d46e18ee918e684e5deb27fa4">PRI_EO</a></div><div class="ttdeci">#define PRI_EO</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00097">event_machine_types.h:97</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a0c0a929399ae33b615f8ca8018d2a69d"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a0c0a929399ae33b615f8ca8018d2a69d">em_escope_t</a></div><div class="ttdeci">uint32_t em_escope_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00348">event_machine_types.h:348</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a3f2bef96eaf8b2855699d6adee7758f4"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a3f2bef96eaf8b2855699d6adee7758f4">EM_QUEUE_GROUP_UNDEF</a></div><div class="ttdeci">#define EM_QUEUE_GROUP_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00127">event_machine_types.h:127</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a419c8373b72a8c5ed1c3e3ded3e262e0"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a419c8373b72a8c5ed1c3e3ded3e262e0">EM_TRUE</a></div><div class="ttdeci">#define EM_TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00053">event_machine_types.h:53</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a47c0f0da93addf232d3d6b720f0bb262"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a47c0f0da93addf232d3d6b720f0bb262">em_queue_type_t</a></div><div class="ttdeci">uint32_t em_queue_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00168">event_machine_types.h:168</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a49fd700da185b0f64834bf967479a992"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a49fd700da185b0f64834bf967479a992">em_event_type_t</a></div><div class="ttdeci">uint32_t em_event_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00085">event_machine_types.h:85</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_a8542d9c2c9a29e35ff042b1d59cc479b"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#a8542d9c2c9a29e35ff042b1d59cc479b">EM_EVENT_UNDEF</a></div><div class="ttdeci">#define EM_EVENT_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00062">event_machine_types.h:62</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_adddd88868f7aa0d32b3e40245eb4ef8f"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#adddd88868f7aa0d32b3e40245eb4ef8f">em_status_t</a></div><div class="ttdeci">uint32_t em_status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00321">event_machine_types.h:321</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_ae8ba676fb5528d220363edad0aeef1ff"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#ae8ba676fb5528d220363edad0aeef1ff">EM_QUEUE_UNDEF</a></div><div class="ttdeci">#define EM_QUEUE_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00107">event_machine_types.h:107</a></div></div>
<div class="ttc" id="aevent__machine__types_8h_html_af28fb8daf62b942ced417e158ed7e1c7"><div class="ttname"><a href="../../d4/d11/event__machine__types_8h.html#af28fb8daf62b942ced417e158ed7e1c7">EM_EO_UNDEF</a></div><div class="ttdeci">#define EM_EO_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00095">event_machine_types.h:95</a></div></div>
<div class="ttc" id="agroup__em__core_html_ga13d21af31382ec2c3d45010645707e9c"><div class="ttname"><a href="../../d5/d69/group__em__core.html#ga13d21af31382ec2c3d45010645707e9c">em_core_id</a></div><div class="ttdeci">int em_core_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/df9/event__machine__core_8c_source.html#l00034">event_machine_core.c:34</a></div></div>
<div class="ttc" id="agroup__em__dispatcher_html_ga50a0ef57733fbe0bf06ccfd0e3c2a665"><div class="ttname"><a href="../../d3/db8/group__em__dispatcher.html#ga50a0ef57733fbe0bf06ccfd0e3c2a665">em_dispatch_register_enter_cb</a></div><div class="ttdeci">em_status_t em_dispatch_register_enter_cb(em_dispatch_enter_func_t func)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0d/event__machine__dispatcher_8c_source.html#l00274">event_machine_dispatcher.c:274</a></div></div>
<div class="ttc" id="agroup__em__dispatcher_html_ga867519ecfc13f60713d54b419cdc2f25"><div class="ttname"><a href="../../d3/db8/group__em__dispatcher.html#ga867519ecfc13f60713d54b419cdc2f25">em_dispatch_register_exit_cb</a></div><div class="ttdeci">em_status_t em_dispatch_register_exit_cb(em_dispatch_exit_func_t func)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0d/event__machine__dispatcher_8c_source.html#l00312">event_machine_dispatcher.c:312</a></div></div>
<div class="ttc" id="agroup__em__eo_html_ga10cf8094caa56026eb0a402d3d22da23"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#ga10cf8094caa56026eb0a402d3d22da23">em_eo_remove_queue_all_sync</a></div><div class="ttdeci">em_status_t em_eo_remove_queue_all_sync(em_eo_t eo, int delete_queues)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00517">event_machine_eo.c:517</a></div></div>
<div class="ttc" id="agroup__em__eo_html_ga196c7caa1177575fd424e9a0d2854da6"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#ga196c7caa1177575fd424e9a0d2854da6">em_eo_create</a></div><div class="ttdeci">em_eo_t em_eo_create(const char *name, em_start_func_t start, em_start_local_func_t local_start, em_stop_func_t stop, em_stop_local_func_t local_stop, em_receive_func_t receive, const void *eo_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00040">event_machine_eo.c:40</a></div></div>
<div class="ttc" id="agroup__em__eo_html_gabe4f7a789ec9523367c086793061562d"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#gabe4f7a789ec9523367c086793061562d">em_eo_start_sync</a></div><div class="ttdeci">em_status_t em_eo_start_sync(em_eo_t eo, em_status_t *result, const em_eo_conf_t *conf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00725">event_machine_eo.c:725</a></div></div>
<div class="ttc" id="agroup__em__eo_html_gac9b818edd466228b6fb653bd9337da3e"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#gac9b818edd466228b6fb653bd9337da3e">em_eo_add_queue_sync</a></div><div class="ttdeci">em_status_t em_eo_add_queue_sync(em_eo_t eo, em_queue_t queue)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00344">event_machine_eo.c:344</a></div></div>
<div class="ttc" id="agroup__em__eo_html_gadce026621953114bd26e5836d9693465"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#gadce026621953114bd26e5836d9693465">em_eo_stop_sync</a></div><div class="ttdeci">em_status_t em_eo_stop_sync(em_eo_t eo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00897">event_machine_eo.c:897</a></div></div>
<div class="ttc" id="agroup__em__eo_html_gae769b19e613b24487beb943cfb926977"><div class="ttname"><a href="../../d8/d5f/group__em__eo.html#gae769b19e613b24487beb943cfb926977">em_eo_delete</a></div><div class="ttdeci">em_status_t em_eo_delete(em_eo_t eo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/event__machine__eo_8c_source.html#l00205">event_machine_eo.c:205</a></div></div>
<div class="ttc" id="agroup__em__error_html_gab6b469100e5f60670a742d944a6f530b"><div class="ttname"><a href="../../db/da0/group__em__error.html#gab6b469100e5f60670a742d944a6f530b">em_unregister_error_handler</a></div><div class="ttdeci">em_status_t em_unregister_error_handler(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/de9/event__machine__error_8c_source.html#l00050">event_machine_error.c:50</a></div></div>
<div class="ttc" id="agroup__em__error_html_gaf7332965c5deaa69411136e8d36089c6"><div class="ttname"><a href="../../db/da0/group__em__error.html#gaf7332965c5deaa69411136e8d36089c6">em_register_error_handler</a></div><div class="ttdeci">em_status_t em_register_error_handler(em_error_handler_t handler)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/de9/event__machine__error_8c_source.html#l00034">event_machine_error.c:34</a></div></div>
<div class="ttc" id="agroup__em__event_html_ga5f0e40f1b0b4892ee16aafe07ba4c90c"><div class="ttname"><a href="../../d5/d33/group__em__event.html#ga5f0e40f1b0b4892ee16aafe07ba4c90c">em_alloc</a></div><div class="ttdeci">em_event_t em_alloc(uint32_t size, em_event_type_t type, em_pool_t pool)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d32/event__machine__event_8c_source.html#l00033">event_machine_event.c:33</a></div></div>
<div class="ttc" id="agroup__em__event_html_ga8f701c3a5901fc81d922b9d1d02691e3"><div class="ttname"><a href="../../d5/d33/group__em__event.html#ga8f701c3a5901fc81d922b9d1d02691e3">em_event_pointer</a></div><div class="ttdeci">void * em_event_pointer(em_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d32/event__machine__event_8c_source.html#l00750">event_machine_event.c:750</a></div></div>
<div class="ttc" id="agroup__em__event_html_gaca4584a01b71429dfbb045342454b464"><div class="ttname"><a href="../../d5/d33/group__em__event.html#gaca4584a01b71429dfbb045342454b464">em_send</a></div><div class="ttdeci">em_status_t em_send(em_event_t event, em_queue_t queue)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d32/event__machine__event_8c_source.html#l00661">event_machine_event.c:661</a></div></div>
<div class="ttc" id="agroup__em__event_html_gad4f97ba217518d967f8078c56023c4d4"><div class="ttname"><a href="../../d5/d33/group__em__event.html#gad4f97ba217518d967f8078c56023c4d4">em_free</a></div><div class="ttdeci">void em_free(em_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d32/event__machine__event_8c_source.html#l00261">event_machine_event.c:261</a></div></div>
<div class="ttc" id="agroup__em__queue__group_html_ga6f3e8e31f260f65abc902aad59c4497d"><div class="ttname"><a href="../../d9/d01/group__em__queue__group.html#ga6f3e8e31f260f65abc902aad59c4497d">em_queue_group_create_sync</a></div><div class="ttdeci">em_queue_group_t em_queue_group_create_sync(const char *name, const em_core_mask_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd9/event__machine__queue__group_8c_source.html#l00076">event_machine_queue_group.c:76</a></div></div>
<div class="ttc" id="agroup__em__queue_html_gaef257858d1fa660524f198dba20fa9eb"><div class="ttname"><a href="../../de/d3c/group__em__queue.html#gaef257858d1fa660524f198dba20fa9eb">em_queue_create</a></div><div class="ttdeci">em_queue_t em_queue_create(const char *name, em_queue_type_t type, em_queue_prio_t prio, em_queue_group_t group, const em_queue_conf_t *conf)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dba/event__machine__queue_8c_source.html#l00041">event_machine_queue.c:41</a></div></div>
<div class="ttc" id="agroup__em__scheduler_html_gaf80e7173968f134ff3a9df6509c17009"><div class="ttname"><a href="../../dd/d1b/group__em__scheduler.html#gaf80e7173968f134ff3a9df6509c17009">em_atomic_processing_end</a></div><div class="ttdeci">void em_atomic_processing_end(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d1f/event__machine__scheduler_8c_source.html#l00034">event_machine_scheduler.c:34</a></div></div>
<div class="ttc" id="astructem__core__mask__t_html"><div class="ttname"><a href="../../df/d81/structem__core__mask__t.html">em_core_mask_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d07/event__machine__hw__types_8h_source.html#l00242">event_machine_hw_types.h:242</a></div></div>
<div class="ttc" id="astructem__eo__conf__t_html"><div class="ttname"><a href="../../de/dc0/structem__eo__conf__t.html">em_eo_conf_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d11/event__machine__types_8h_source.html#l00242">event_machine_types.h:242</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
  <div id="footer" class="tabs">
   <div class="headertitle"> 
     &copy; 2017 Nokia Networks
   </div>
  </div>
 </body>
</html>
