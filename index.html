<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EM-ODP: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doc-stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EM-ODP
   &#160;<span id="projectnumber">3.8.0-1</span>
   </div>
   <div id="projectbrief">Event Machine on ODP</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EM-ODP Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section_1"></a>
General</h1>
<p>Event Machine (EM) is a framework and an architectural abstraction of an event driven, multicore optimized, processing concept originally developed for the networking data plane. It offers an easy programming concept for scalable and dynamically load balanced multicore applications with a very low overhead run-to-completion principle.</p>
<p>Events, queues and execution objects (EO) along with the scheduler and the dispatcher form the main elements of the EM concept. An event is an application specific piece of data (like a message or a network packet) describing work, something to do. All processing in EM must be triggered by an event. Events are sent to asynchronous application specific EM queues. A dispatcher loop is run by a single thread on each core in the EM instance ("core" is used here to refer to a core or one HW thread on multi-threaded cores). The dispatcher on each core interfaces with the scheduler and asks for an event to process. The scheduler then evaluates the state of all the EM queues and gives the highest priority event available to the requesting dispatcher. The dispatcher looks up which EO owns the queue that the event came from and finally calls the EO's registered receive function to deliver the event for processing. When the event has been handled and the EO's receive function returns, it's again time for the dispatcher on that core to request another event from the scheduler and deliver it to the corresponding EO. The aforedescribed scenario happens in parallel on all cores running the EM instance. Events originating from a particular queue might thus be given for processing on any core, decided separately for each event by the scheduler as the dispatcher on a core requests more work - this is per-event dynamic load-balancing. EM contains mechanisms to ensure atomicity and event (re-)ordering.</p>
<p>The EM concept has been designed to be highly efficient, operating in a run-to-completion manner on each participating core with neither context switching nor pre-emption slowing down the event processing loops. EM can run on bare metal for best performance or under an operating system with special arrangements (e.g. one thread per core with thread affinity).</p>
<p>The concept and the API are intended to allow fairly easy implementations on general purpose or networking oriented multicore packet processing SoCs, which typically also contain accelerators for packet processing needs. Efficient integration with modern HW accelerators has been a major driver of the EM concept.</p>
<p>One general principle of the EM API is that the function calls are mostly multicore safe. The application still needs to consider parallel processing data hazards and race conditions unless explicitly documented in the API for the function call in question. For example, one core might ask for a queue context while another core changes it, thus the returned context may be invalid (valid data, but either the old or the new value is returned). Thus modifications of shared state or data should be protected by an atomic context (if load balancing is used) or otherwise synchronized by the application itself. One simple way to achieve atomic processing is to use an atomic queue to serialize the EO's incoming events and perform management operations in the EO's receive function. This serialization limits the throughput of the atomic queue in question to the equivalent throughput of a single core, but since normally EM applications use multiple queues, all cores should get events to process and the total throughput will be relative to the number of cores running the EM instance.</p>
<p>EM_64_BIT or EM_32_BIT (needs to be defined by the build) defines whether (most of) the types used in the API are 32 or 64 bits wide. NOTE, that this is a major decision, since it may limit value passing between different systems using the defined types directly. Using 64-bits may allow for a more efficient underlying implementation, as e.g. more data can be coded in 64-bit identifiers.</p>
<h1><a class="anchor" id="section_2"></a>
Principles</h1>
<ul>
<li>This API attempts to guide towards a portable application architecture, but is not defined for portability by re-compilation. Many things are system specific giving more possibilities for efficient use of HW resources.</li>
<li>EM does not define event content (one exception, see <a class="el" href="d5/d33/group__em__event.html#ga5f0e40f1b0b4892ee16aafe07ba4c90c">em_alloc()</a>). This is a choice made for performance reasons, since most HW devices use proprietary descriptors. This API enables the usage of those directly.</li>
<li>EM does not define a detailed queue scheduling discipline or an API to set it up with (or actually anything to configure a system). The priority value in this API is a (mapped) system specific QoS class label only.</li>
<li>In general, EM does not implement a full SW platform or a middleware solution, it implements a subset - a driver level part. For best performance it can be used directly from the applications.</li>
</ul>
<h1><a class="anchor" id="section_3"></a>
Inter-system communication</h1>
<p>EM does not define how to communicate with another EM instance or another system transparently. However, this is a typical need and the current API does have ways to achieve almost transparent communication between systems ("event chaining"): Since the queue identifier is a system specific value, it is easy to encode extra information into it in the EM implementation. For instance it could be split into two parts, where the lower part is a local queue id or index and the higher part, if not zero, points to another system. The implementation of <a class="el" href="d5/d33/group__em__event.html#gaca4584a01b71429dfbb045342454b464">em_send()</a> can detect a non-local queue and forward events to the target using any transport mechanism available and once at the target instance the lower part is used to map to a local queue. For the application nothing changes. The problem is the lack of shared memory between those systems. The given event can be fully copied, but it should not have any references to sender's local memory. Thus it is not fully transparent if the event contains references to local memory (e.g. pointers).</p>
<h1><a class="anchor" id="section_4"></a>
Files</h1>
<h2><a class="anchor" id="sub_1"></a>
Generic</h2>
<ul>
<li><a class="el" href="d7/d5e/event__machine_8h.html">event_machine.h</a><ul>
<li>Event Machine API The application should include this file only.</li>
</ul>
</li>
</ul>
<p>Files included by <a class="el" href="d7/d5e/event__machine_8h.html">event_machine.h</a>:</p><ul>
<li><a class="el" href="d1/d24/event__machine__version_8h.html">event_machine_version.h</a><ul>
<li>Event Machine version defines, macros and APIs</li>
</ul>
</li>
<li><a class="el" href="da/dde/event__machine__deprecated_8h.html">event_machine_deprecated.h</a><ul>
<li>EM API deprecation defines &amp; macros</li>
</ul>
</li>
<li><a class="el" href="d4/d11/event__machine__types_8h.html">event_machine_types.h</a><ul>
<li>Event Machine basic types</li>
</ul>
</li>
<li><a class="el" href="d2/d2e/event__machine__event_8h.html">event_machine_event.h</a><ul>
<li>event related functionality</li>
</ul>
</li>
<li><a class="el" href="d2/df2/event__machine__packet_8h.html">event_machine_packet.h</a><ul>
<li>packet event related functionality</li>
</ul>
</li>
<li><a class="el" href="d1/d5e/event__machine__eo_8h.html">event_machine_eo.h</a><ul>
<li>EO related functionality</li>
</ul>
</li>
<li><a class="el" href="d0/d9e/event__machine__event__group_8h.html">event_machine_event_group.h</a><ul>
<li>event group feature for fork-join type of operations using events</li>
</ul>
</li>
<li><a class="el" href="db/d2f/event__machine__atomic__group_8h.html">event_machine_atomic_group.h</a><ul>
<li>functionality for atomic groups of queues (API 1.1)</li>
</ul>
</li>
<li><a class="el" href="dd/dd8/event__machine__queue_8h.html">event_machine_queue.h</a><ul>
<li>queue related functionality</li>
</ul>
</li>
<li><a class="el" href="de/d50/event__machine__queue__group_8h.html">event_machine_queue_group.h</a><ul>
<li>queue group related functionality</li>
</ul>
</li>
<li><a class="el" href="d8/d1e/event__machine__error_8h.html">event_machine_error.h</a><ul>
<li>error management related functionality</li>
</ul>
</li>
<li><a class="el" href="db/d16/event__machine__core_8h.html">event_machine_core.h</a><ul>
<li>core/thread related functionality</li>
</ul>
</li>
<li><a class="el" href="d1/da7/event__machine__scheduler_8h.html">event_machine_scheduler.h</a><ul>
<li>scheduling related functionality</li>
</ul>
</li>
<li><a class="el" href="d0/de5/event__machine__dispatcher_8h.html">event_machine_dispatcher.h</a><ul>
<li>dispatching related functionality</li>
</ul>
</li>
<li>event_machine_timer.h<ul>
<li>timer APIs</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="sub_2"></a>
Platform Specific</h2>
<p>(also included by <a class="el" href="d7/d5e/event__machine_8h.html">event_machine.h</a>)</p><ul>
<li><a class="el" href="dd/dca/event__machine__config_8h.html">event_machine_config.h</a><ul>
<li>Event Machine constants and configuration options</li>
</ul>
</li>
<li><a class="el" href="db/d6d/event__machine__hw__config_8h.html">event_machine_hw_config.h</a><ul>
<li>HW specific constants and configuration options</li>
</ul>
</li>
<li><a class="el" href="d3/d7b/event__machine__hw__specific_8h.html">event_machine_hw_specific.h</a><ul>
<li>HW specific functions and macros</li>
</ul>
</li>
<li><a class="el" href="d0/d07/event__machine__hw__types_8h.html">event_machine_hw_types.h</a><ul>
<li>HW specific types</li>
</ul>
</li>
<li><a class="el" href="d8/deb/event__machine__hooks_8h.html">event_machine_hooks.h</a><ul>
<li>API-hooks and idle-hooks</li>
</ul>
</li>
<li><a class="el" href="dc/d78/event__machine__init_8h.html">event_machine_init.h</a><ul>
<li>Event Machine initialization</li>
</ul>
</li>
<li><a class="el" href="d2/d8f/event__machine__pool_8h.html">event_machine_pool.h</a><ul>
<li>event pool related functionality</li>
</ul>
</li>
<li><a class="el" href="d7/d1f/event__machine__timer__hw__specific_8h.html">event_machine_timer_hw_specific.h</a><ul>
<li>Platform specific timer definitions</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="sub_3"></a>
Helper</h2>
<p>These files must be separately included by the application on a need basis.</p><ul>
<li><a class="el" href="da/d50/event__machine__helper_8h.html">event_machine_helper.h</a><ul>
<li>optional helper routines</li>
</ul>
</li>
<li><a class="el" href="d5/d5d/event__machine__debug_8h.html">event_machine_debug.h</a><ul>
<li>optional debug helpers (only for debug use)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="sub_4"></a>
Extensions</h2>
<p>These files must be separately included by the application on a need basis.</p><ul>
<li><a class="el" href="d5/dbf/event__machine__odp__ext_8h.html">event_machine_odp_ext.h</a><ul>
<li>EM &lt;-&gt; ODP conversion functions and ODP related helpers </li>
</ul>
</li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
  <div id="footer" class="tabs">
   <div class="headertitle"> 
     &copy; 2017 Nokia Networks
   </div>
  </div>
 </body>
</html>
